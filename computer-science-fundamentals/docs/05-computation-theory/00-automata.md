# オートマトンと形式言語

> 正規表現、コンパイラ、プロトコル検証——オートマトン理論はCSの理論的基盤であり、実務にも深く浸透している。

## この章で学ぶこと

- [ ] 有限オートマトン（DFA/NFA）の仕組みを理解する
- [ ] 正規言語と文脈自由言語の違いを説明できる
- [ ] チョムスキー階層を理解する

## 前提知識

- 基本的なプログラミング知識

---

## 1. 有限オートマトン

### 1.1 DFA（決定性有限オートマトン）

```
DFA の定義:
  M = (Q, Σ, δ, q₀, F)

  Q: 状態の有限集合
  Σ: 入力アルファベット
  δ: 遷移関数 Q × Σ → Q
  q₀: 初期状態
  F: 受理状態の集合

  例: 偶数個の'a'を含む文字列を受理するDFA

  状態遷移図:
    ┌──b──┐     ┌──b──┐
    │     ↓     │     ↓
  →(q0)──a──→(q1)
    ↑←────a────┘

  q0: 偶数個のa（受理状態）
  q1: 奇数個のa

  δ(q0, a) = q1, δ(q0, b) = q0
  δ(q1, a) = q0, δ(q1, b) = q1

  "abba" → q0→q1→q1→q1→q0 → 受理 ✓
  "aba"  → q0→q1→q1→q0    → 受理 ✓
  "a"    → q0→q1           → 拒否 ✗
```

### 1.2 正規表現との対応

```
正規表現 ↔ DFA/NFA は等価:

  正規表現       対応するオートマトン        実務での用途
  ──────────────────────────────────────────────────
  a*b           ab前の任意個のa              grep, sed
  [0-9]+        1桁以上の数字                入力検証
  (ab|cd)*      abまたはcdの繰り返し          プロトコル検証
  .*@.*\\..*    簡易メールアドレス検証        フォームバリデーション

  実務: 正規表現エンジンは内部的にNFA/DFAに変換して実行
  → NFA方式: O(n×m) 保証（Go, Rust, RE2）
  → バックトラック方式: O(2^n) 最悪（Python, JS, Java）
```

---

## 2. チョムスキー階層

```
チョムスキー階層: 言語の表現力による分類

  タイプ0: 帰納的可算言語  ← チューリングマシン
      ↑
  タイプ1: 文脈依存言語    ← 線形有界オートマトン
      ↑
  タイプ2: 文脈自由言語    ← プッシュダウンオートマトン
      ↑                     (プログラミング言語の構文)
  タイプ3: 正規言語        ← 有限オートマトン
                              (正規表現、字句解析)

  実務での対応:
  正規言語:     トークン分割（字句解析）、入力検証
  文脈自由言語: プログラミング言語の構文（構文解析）
  文脈依存:     型チェック、スコープ解析
  帰納的可算:   プログラムの停止性判定（判定不能！）
```

---

## 3. コンパイラとの関係

```
コンパイラのフロントエンド:

  ソースコード
    │
    ▼ 字句解析（レクサー）← 正規言語（DFA）
  トークン列
    │
    ▼ 構文解析（パーサー）← 文脈自由言語（PDA）
  構文木（AST）
    │
    ▼ 意味解析 ← 文脈依存（型チェック等）
  注釈付きAST

  例: "x = 3 + 5;"
  字句解析: [ID("x"), ASSIGN, INT(3), PLUS, INT(5), SEMICOLON]
  構文解析:
       =
      / \
     x   +
        / \
       3   5
```

---

## 4. 実践演習

### 演習1: DFA設計（基礎）
"01"で終わる2進数文字列を受理するDFAを設計せよ。

### 演習2: 正規表現→NFA（応用）
正規表現 `(a|b)*abb` をNFAに変換し、"aabb"が受理されるか追跡せよ。

### 演習3: 簡易レクサー（発展）
正規表現ベースの簡易字句解析器を実装せよ。

---

## まとめ

| 概念 | ポイント |
|------|---------|
| DFA | 決定的。各状態から一意の遷移。正規表現と等価 |
| NFA | 非決定的。DFAと等価だが状態数が指数的に増える場合あり |
| 正規言語 | 正規表現で記述可能。字句解析に使用 |
| 文脈自由言語 | BNFで記述可能。構文解析に使用 |
| チョムスキー階層 | 4段階の言語クラス。上位ほど表現力が高い |

---

## 次に読むべきガイド
→ [[01-computability.md]] — 計算可能性

---

## 参考文献
1. Hopcroft, J. E., Motwani, R., Ullman, J. D. "Introduction to Automata Theory, Languages, and Computation." 3rd Edition.
2. Sipser, M. "Introduction to the Theory of Computation." 3rd Edition.
