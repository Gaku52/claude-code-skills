# 電子回路の基礎

> 全てのソフトウェアは究極的にはトランジスタの ON/OFF の組み合わせで実行される。

## この章で学ぶこと

- [ ] トランジスタが論理ゲートを構成する仕組みを説明できる
- [ ] 論理ゲートの組み合わせで加算器を構成できることを理解する
- [ ] 半導体製造プロセスの概要を説明できる

## 前提知識

- 2進数の基礎があると理解が深まる → 参照: [[../02-data-representation/00-binary-and-number-systems.md]]

---

## 1. トランジスタ — コンピュータの最小構成要素

### 1.1 MOSFETの動作

```
MOSFET（Metal-Oxide-Semiconductor Field-Effect Transistor）:

  NMOS トランジスタ:
         ゲート (G)
           │
  ┌────────┴────────┐
  │    酸化膜 (SiO2) │
  ├─────────────────┤
  │    チャネル       │
  ├────┬────────┬───┤
  │ Source │        │ Drain│
  │ (S)   │   P基板 │ (D)  │
  └────────┴────────┴──────┘

  動作:
  - ゲート電圧 = 0V → チャネル閉 → 電流流れない → OFF (0)
  - ゲート電圧 = Vdd → チャネル開 → 電流流れる → ON (1)
  → 電圧でON/OFFを切り替えるスイッチ
```

### 1.2 なぜトランジスタが重要か

- 1個のトランジスタ = 1個のスイッチ（ON/OFF = 1/0）
- 2個のトランジスタ = 1個の論理ゲート（NOT）
- 4個のトランジスタ = NANDゲート（万能ゲート）
- NANDの組み合わせで**あらゆる論理回路**を構成可能
- Apple M4チップ: 約280億個のトランジスタ

---

## 2. 論理ゲート

### 2.1 基本ゲート

```
基本論理ゲートの真理値表:

NOT:           AND:          OR:           XOR:
A │ Y         A B │ Y       A B │ Y       A B │ Y
──┼──         ────┼──       ────┼──       ────┼──
0 │ 1         0 0 │ 0       0 0 │ 0       0 0 │ 0
1 │ 0         0 1 │ 0       0 1 │ 1       0 1 │ 1
              1 0 │ 0       1 0 │ 1       1 0 │ 1
              1 1 │ 1       1 1 │ 1       1 1 │ 0

NAND（万能ゲート）:
A B │ Y
────┼──
0 0 │ 1    ← NANDだけで全てのゲートを構成可能
0 1 │ 1      NOT(A) = NAND(A, A)
1 0 │ 1      AND(A,B) = NOT(NAND(A,B))
1 1 │ 0      OR(A,B) = NAND(NOT(A), NOT(B))
```

### 2.2 論理ゲートから加算器へ

```
半加算器（Half Adder）: 1ビットの加算

  A ──┬──[XOR]── Sum (和)
      │
  B ──┤
      │
      └──[AND]── Carry (繰り上がり)

  A B │ Sum Carry
  ────┼──────────
  0 0 │  0    0
  0 1 │  1    0
  1 0 │  1    0
  1 1 │  0    1    ← 1+1=10(2進数)

全加算器（Full Adder）: 繰り上がり入力付き
  → 半加算器2つ + ORゲート1つで構成
  → N個連結すれば N ビット加算器

  8ビット加算器 = 8個の全加算器
  → CPU の ALU の中核
```

---

## 3. 半導体製造

### 3.1 製造プロセス概要

```
半導体製造の流れ:

  1. シリコンウェハー製造
     砂 (SiO2) → 精製 → 単結晶シリコンインゴット → ウェハーにスライス

  2. フォトリソグラフィ（繰り返し）
     ┌─────────┐    ┌─────────┐    ┌─────────┐
     │ 塗布    │───→│ 露光    │───→│ エッチング│
     │(フォト   │    │(回路パターン│  │(不要部分 │
     │ レジスト)│    │ を焼き付け)│  │ を除去)  │
     └─────────┘    └─────────┘    └─────────┘
     → 100層以上繰り返して3D構造を形成

  3. テスト → ダイシング → パッケージング → 完成

  プロセスノード（nm）の進化:
  90nm(2004) → 65nm → 45nm → 32nm → 22nm → 14nm → 7nm → 5nm → 3nm(2023)
  → 数字が小さいほど微細化（トランジスタが小さい）
  → 同面積により多くのトランジスタを詰められる
```

### 3.2 製造の課題

| プロセス | 年 | トランジスタ/mm² | 製造コスト/ウェハー | 主な製造者 |
|---------|-----|---------------|-----------------|----------|
| 7nm | 2018 | 〜96M | 〜$10,000 | TSMC, Samsung |
| 5nm | 2020 | 〜171M | 〜$17,000 | TSMC, Samsung |
| 3nm | 2023 | 〜292M | 〜$20,000+ | TSMC |
| 2nm | 2025 | 〜400M+ | 〜$30,000+ | TSMC, Intel, Samsung |

→ 微細化するほどコストが指数的に増加（EUVリソグラフィ装置: 1台約200億円）

---

## 4. 実践演習

### 演習1: 論理回路の設計（基礎）
NANDゲートだけを使って、以下のゲートを構成する回路図を描け:
1. NOT
2. AND
3. OR

### 演習2: 加算器の実装（応用）
好きなプログラミング言語で、ビット演算のみを使って8ビット加算器を実装せよ（+演算子を使わずに）。

### 演習3: Nand2Tetris（発展）
「The Elements of Computing Systems」（Nand2Tetris）のProject 1-2を完了し、NANDゲートからALUまでを構築せよ。

---

## FAQ

### Q1: なぜシリコンが使われるのですか？
**A**: シリコンは半導体であり、不純物の添加（ドーピング）で電気的特性を精密に制御できる。地殻の25%を構成するため原料が豊富で安価。

### Q2: ムーアの法則の限界は？
**A**: 原子サイズ（約0.1nm）に近づいており、物理的限界が見えている。3nm以下では量子トンネリング効果でリーク電流が増大。対策としてGAA FET、3D積層、チップレット技術が発展中。

### Q3: ソフトウェアエンジニアが回路を知る必要は？
**A**: 必須ではないが、以下の理解に役立つ:
- なぜコンピュータが2進数を使うか（トランジスタのON/OFF）
- なぜ浮動小数点に誤差があるか（ビット幅の制約）
- なぜCPUの速度に物理的限界があるか（微細化と発熱）

---

## まとめ

| 概念 | ポイント |
|------|---------|
| トランジスタ | ON/OFFスイッチ。全ての計算の最小単位 |
| 論理ゲート | NOT, AND, OR, NAND。NANDだけで万能 |
| 加算器 | 論理ゲートの組み合わせで算術演算を実現 |
| 製造 | フォトリソグラフィで微細化。3nm時代に突入 |

---

## 次に読むべきガイド
→ [[07-capacity-limits.md]] — 性能限界とコンピューティングの未来

---

## 参考文献
1. Nisan, N. & Schocken, S. "The Elements of Computing Systems (Nand2Tetris)." MIT Press, 2nd Edition, 2021.
2. Weste, N. & Harris, D. "CMOS VLSI Design." 4th Edition, Pearson, 2010.
3. Mead, C. & Conway, L. "Introduction to VLSI Systems." Addison-Wesley, 1980.
