# 計算複雑性理論

> P ≠ NP 問題はCS最大の未解決問題であり、その答えは暗号、最適化、AI の基盤を根本から変える可能性がある。

## この章で学ぶこと

- [ ] P, NP, NP完全, NP困難の定義を説明できる
- [ ] P ≠ NP 問題の意味を理解する
- [ ] NP完全問題への実務的な対処法を知る

---

## 1. 複雑性クラス

### 1.1 P と NP

```
P（Polynomial time）:
  多項式時間で「解ける」問題のクラス
  例: ソート O(n log n), 最短経路 O(V² + E), 素数判定

NP（Nondeterministic Polynomial time）:
  多項式時間で「解の正しさを検証できる」問題のクラス
  例: 巡回セールスマン問題（最短経路を「見つける」のは困難だが、
      与えられた経路が最短以下かの「検証」は容易）

  P ⊆ NP は自明（解けるなら検証もできる）
  P = NP ? は未解決（100万ドルの懸賞金）

  直感的な意味:
  P = NP なら: 「検証が容易な問題は、解くのも容易」
  → 暗号が崩壊（暗号の安全性は「解くのが困難」に依存）
  → 最適化問題が効率的に解ける
  → AIが飛躍的に進歩

  P ≠ NP なら: 「検証が容易でも、解くのは本質的に困難な問題が存在」
  → 現在の暗号は安全
  → 真に困難な問題が存在する
  → ほとんどの研究者はこちらを予想
```

### 1.2 NP完全とNP困難

```
NP完全（NP-Complete）:
  NPの中で「最も難しい」問題のクラス
  任意のNP問題をNP完全問題に多項式時間で帰着できる
  1つのNP完全問題が多項式時間で解ければ P = NP

  代表的なNP完全問題:
  - SAT（充足可能性問題）← Cook-Levin定理で最初に証明
  - 巡回セールスマン問題（判定版）
  - グラフ彩色問題
  - ナップサック問題
  - ハミルトン閉路問題
  - クリーク問題
  - 集合被覆問題

NP困難（NP-Hard）:
  少なくともNP完全と同程度に難しい問題
  NP完全 = NP ∩ NP困難
  NPに属さない場合もある（検証すら困難）
```

---

## 2. 実務での対処

```
NP完全問題に直面した時の選択肢:

  1. 厳密解（小規模のみ）
     → ビット全探索: n ≤ 20
     → 動的計画法: 指数時間だが高速化 O(n² × 2^n)
     → 分岐限定法: 枝刈りで実用的に解ける場合あり

  2. 近似アルゴリズム
     → 最適解の定数倍以内を保証
     → 例: 頂点被覆 2-近似、TSP 3/2-近似（Christofides）

  3. ヒューリスティック
     → 焼きなまし法、遺伝的アルゴリズム、タブー探索
     → 保証なしだが実用的に良い解
     → 例: Google OR-Tools

  4. 特殊ケースへの帰着
     → 入力が特殊な構造を持つ場合、多項式時間で解ける
     → 例: 木上のTSP、平面グラフの彩色

  5. パラメータ化計算量
     → 入力の一部のパラメータが小さい場合
     → FPT: O(f(k) × n^c) — kが小さければ効率的
```

---

## 3. 実践演習

### 演習1: NP完全の帰着（基礎）
独立集合問題が頂点被覆問題に帰着できることを示せ。

### 演習2: 近似アルゴリズム（応用）
貪欲法による集合被覆の近似アルゴリズムを実装し、近似比を実測せよ。

---

## まとめ

| 概念 | ポイント |
|------|---------|
| P | 多項式時間で解ける。ソート、最短経路等 |
| NP | 多項式時間で検証できる。P ⊆ NP |
| NP完全 | NPで最も難しい。1つ解ければ全NP問題が解ける |
| P ≠ NP? | CS最大の未解決問題。暗号の安全性に直結 |
| 対処法 | 近似、ヒューリスティック、特殊ケース |

---

## 次に読むべきガイド
→ [[03-information-theory.md]] — 情報理論

---

## 参考文献
1. Sipser, M. "Introduction to the Theory of Computation." Chapters 7-8.
2. Arora, S. & Barak, B. "Computational Complexity: A Modern Approach." Cambridge, 2009.
3. Cook, S. A. "The Complexity of Theorem-Proving Procedures." STOC, 1971.
