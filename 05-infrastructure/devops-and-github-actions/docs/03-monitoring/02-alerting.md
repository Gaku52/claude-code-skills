# ã‚¢ãƒ©ãƒ¼ãƒˆæˆ¦ç•¥

> ã‚¢ãƒ©ãƒ¼ãƒˆè¨­è¨ˆã®åŸå‰‡ã€ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒªã‚·ãƒ¼ã€ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã®é‹ç”¨ã‚’ç¿’å¾—ã—ã€ã‚¢ãƒ©ãƒ¼ãƒˆç–²ã‚Œã®ãªã„æŒç¶šå¯èƒ½ãªã‚ªãƒ³ã‚³ãƒ¼ãƒ«ä½“åˆ¶ã‚’æ§‹ç¯‰ã™ã‚‹

## ã“ã®ç« ã§å­¦ã¶ã“ã¨

1. **åŠ¹æœçš„ãªã‚¢ãƒ©ãƒ¼ãƒˆè¨­è¨ˆ** â€” ã‚¢ãƒ©ãƒ¼ãƒˆç–²ã‚Œã‚’é˜²ãã€æœ¬å½“ã«å¯¾å¿œãŒå¿…è¦ãªã‚¢ãƒ©ãƒ¼ãƒˆã ã‘ã‚’ç™ºå ±ã™ã‚‹è¨­è¨ˆåŸå‰‡
2. **ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚ªãƒ³ã‚³ãƒ¼ãƒ«ä½“åˆ¶** â€” æ®µéšçš„ãªã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒªã‚·ãƒ¼ã¨ã‚ªãƒ³ã‚³ãƒ¼ãƒ«ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®æ§‹ç¯‰
3. **ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã¨ç¶™ç¶šçš„æ”¹å–„** â€” éšœå®³ã‹ã‚‰å­¦ã³ã€å†ç™ºé˜²æ­¢ã‚’çµ„ç¹”çš„ã«æ¨é€²ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹
4. **è‡ªå‹•ä¿®å¾© (Auto-remediation)** â€” äººé–“ã®ä»‹å…¥ãªã—ã«éšœå®³ã‚’è‡ªå‹•å¾©æ—§ã™ã‚‹ä»•çµ„ã¿ã®æ§‹ç¯‰
5. **ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç†ãƒ—ãƒ­ã‚»ã‚¹** â€” SEV ãƒ¬ãƒ™ãƒ«ã®å®šç¾©ã€ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸ã®é‹ç”¨

---

## 1. ã‚¢ãƒ©ãƒ¼ãƒˆè¨­è¨ˆã®å…¨ä½“åƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ã‚¢ãƒ©ãƒ¼ãƒˆè¨­è¨ˆã®ãƒ”ãƒ©ãƒŸãƒƒãƒ‰                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                    â”‚ PAGE     â”‚  å³åº§ã«å¯¾å¿œãŒå¿…è¦           â”‚
â”‚                    â”‚ (ç·Šæ€¥)   â”‚  SLO é•åã€ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢     â”‚
â”‚                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                   â”‚  TICKET    â”‚  å–¶æ¥­æ™‚é–“å†…ã«å¯¾å¿œ          â”‚
â”‚                   â”‚ (é‡è¦)     â”‚  ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ£åŒ–        â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚              â”‚     NOTIFICATION     â”‚  æƒ…å ±ã¨ã—ã¦é€šçŸ¥       â”‚
â”‚              â”‚     (å‚è€ƒ)           â”‚  å®¹é‡è­¦å‘Šã€è¨¼æ˜æ›¸æœŸé™  â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚         â”‚        DASHBOARD ONLY          â”‚  ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ â”‚
â”‚         â”‚        (è¨˜éŒ²ã®ã¿)               â”‚  ã§ç¢ºèªå¯èƒ½     â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                          â”‚
â”‚  åŸå‰‡: ä¸Šã«è¡Œãã»ã©æ•°ã‚’çµã‚‹ã€‚PAGE ã¯æœˆã«æ•°å›ãŒç†æƒ³ã€‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.1 ã‚¢ãƒ©ãƒ¼ãƒˆè¨­è¨ˆã®åŸå‰‡

```
ã‚¢ãƒ©ãƒ¼ãƒˆã®å“è³ªã‚’æ±ºã‚ã‚‹5ã¤ã®åŸå‰‡:

1. ã‚¢ã‚¯ã‚·ãƒ§ãƒŠãƒ–ãƒ« (Actionable)
   â”€ ã‚¢ãƒ©ãƒ¼ãƒˆã‚’å—ã‘ãŸã‚‰ã€Œä»Šã™ãã‚„ã‚‹ã¹ãã“ã¨ã€ãŒæ˜ç¢º
   â”€ å¯¾å¿œä¸è¦ãªã‚¢ãƒ©ãƒ¼ãƒˆã¯å­˜åœ¨ã™ã¹ãã§ã¯ãªã„

2. ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä»˜ã (Contextual)
   â”€ ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ååˆ†ãªæƒ…å ±ã‚’å«ã‚ã‚‹
   â”€ Runbook URLã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã€å½±éŸ¿ç¯„å›²

3. SLO ãƒ™ãƒ¼ã‚¹ (SLO-based)
   â”€ é™çš„ãªé–¾å€¤ã§ã¯ãªãã€SLO é•åã®äºˆæ¸¬ã«åŸºã¥ã
   â”€ ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆã‚¢ãƒ©ãƒ¼ãƒˆã§ãƒ“ã‚¸ãƒã‚¹ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã‚’åæ˜ 

4. é©åˆ‡ãªç²’åº¦ (Right Granularity)
   â”€ ç—‡çŠ¶ (symptom) ã§ã‚¢ãƒ©ãƒ¼ãƒˆã€åŸå›  (cause) ã¯ãƒ‡ãƒãƒƒã‚°æ™‚
   â”€ ã€ŒCPU 80%ã€ã§ã¯ãªãã€Œãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ãŒSLOé•åã€

5. ç¶™ç¶šçš„ã«æ”¹å–„ (Continuously Improved)
   â”€ æœˆæ¬¡ã§ã‚¢ãƒ©ãƒ¼ãƒˆã‚’æ£šå¸ã—
   â”€ False positive / False negative ã‚’è¿½è·¡
```

### 1.2 ã‚¢ãƒ©ãƒ¼ãƒˆå“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹

```
ã‚¢ãƒ©ãƒ¼ãƒˆã®å“è³ªã‚’å®šé‡çš„ã«è¨ˆæ¸¬ã™ã‚‹æŒ‡æ¨™:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŒ‡æ¨™                     â”‚ ç›®æ¨™å€¤              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PAGE æ•°/æœˆ               â”‚ < 10                â”‚
â”‚ False positive ç‡        â”‚ < 10%               â”‚
â”‚ MTTA (å¹³å‡å¿œç­”æ™‚é–“)       â”‚ < 5åˆ†               â”‚
â”‚ MTTR (å¹³å‡å¾©æ—§æ™‚é–“)       â”‚ < 30åˆ†              â”‚
â”‚ ã‚¢ãƒ©ãƒ¼ãƒˆ â†’ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç‡   â”‚ > 90%               â”‚
â”‚ Runbook ã‚«ãƒãƒ¬ãƒƒã‚¸        â”‚ 100%                â”‚
â”‚ è‡ªå‹•ä¿®å¾©ç‡               â”‚ > 30%               â”‚
â”‚ ã‚ªãƒ³ã‚³ãƒ¼ãƒ«æº€è¶³åº¦          â”‚ > 4/5               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¨ˆæ¸¬æ–¹æ³•:
- PagerDuty / Opsgenie ã®ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½
- ã‚«ã‚¹ã‚¿ãƒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã‚¢ãƒ©ãƒ¼ãƒˆçµ±è¨ˆã‚’å¯è¦–åŒ–
- æœˆæ¬¡ã®ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã§æŒ¯ã‚Šè¿”ã‚Š
```

### 1.3 ç—‡çŠ¶ãƒ™ãƒ¼ã‚¹ vs åŸå› ãƒ™ãƒ¼ã‚¹ã®ã‚¢ãƒ©ãƒ¼ãƒˆ

```
ç—‡çŠ¶ãƒ™ãƒ¼ã‚¹ã‚¢ãƒ©ãƒ¼ãƒˆ (æ¨å¥¨):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½“é¨“ã™ã‚‹å•é¡Œã«ç›´æ¥ç´ã¥ã                    â”‚
â”‚                                                    â”‚
â”‚ ä¾‹:                                                â”‚
â”‚ ãƒ»ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ¼ãƒˆãŒ SLO ã‚’è¶…ãˆã¦ã„ã‚‹                    â”‚
â”‚ ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ã® p99 ãŒ 2ç§’ã‚’è¶…ãˆã¦ã„ã‚‹           â”‚
â”‚ ãƒ»æ³¨æ–‡å‡¦ç†ã®æˆåŠŸç‡ãŒ 99% ã‚’ä¸‹å›ã£ã¦ã„ã‚‹              â”‚
â”‚                                                    â”‚
â”‚ åˆ©ç‚¹:                                              â”‚
â”‚ ãƒ»ãƒ“ã‚¸ãƒã‚¹ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆãŒæ˜ç¢º                          â”‚
â”‚ ãƒ»åŸå› ãŒè¤‡åˆçš„ã§ã‚‚æ¤œçŸ¥ã§ãã‚‹                        â”‚
â”‚ ãƒ»False positive ãŒå°‘ãªã„                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åŸå› ãƒ™ãƒ¼ã‚¹ã‚¢ãƒ©ãƒ¼ãƒˆ (è£œåŠ©çš„ã«ä½¿ç”¨):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚¤ãƒ³ãƒ•ãƒ©ã®çŠ¶æ…‹ã«åŸºã¥ã                               â”‚
â”‚                                                    â”‚
â”‚ ä¾‹:                                                â”‚
â”‚ ãƒ»CPU ä½¿ç”¨ç‡ > 90%                                 â”‚
â”‚ ãƒ»ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨ç‡ > 85%                              â”‚
â”‚ ãƒ»ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ > 90%                                â”‚
â”‚                                                    â”‚
â”‚ æ³¨æ„:                                              â”‚
â”‚ ãƒ»ç—‡çŠ¶ã«å½±éŸ¿ã—ãªã„å ´åˆãŒã‚ã‚‹ (CPU 90% ã§ã‚‚æ­£å¸¸å‹•ä½œ)  â”‚
â”‚ ãƒ»äºˆé˜²çš„ãª TICKET/NOTIFICATION ãƒ¬ãƒ™ãƒ«ã§ä½¿ç”¨          â”‚
â”‚ ãƒ»PAGE ã«ã¯ä½¿ã‚ãªã„                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ã‚¢ãƒ©ãƒ¼ãƒˆãƒ«ãƒ¼ãƒ«ã®è¨­è¨ˆ

### 2.1 SLO ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆã‚¢ãƒ©ãƒ¼ãƒˆ

```yaml
# prometheus-alerts.yml â€” Prometheus ã‚¢ãƒ©ãƒ¼ãƒˆãƒ«ãƒ¼ãƒ«
groups:
  - name: slo-alerts
    rules:
      # SLO ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆã‚¢ãƒ©ãƒ¼ãƒˆ (Multi-window, Multi-burn-rate)
      # 99.9% SLO: 30æ—¥ã§è¨±å®¹ã‚¨ãƒ©ãƒ¼ = 0.1% = 43.2åˆ†ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ 
      - alert: HighErrorBurnRate_Critical
        expr: |
          (
            sum(rate(http_requests_total{status=~"5.."}[5m]))
            / sum(rate(http_requests_total[5m]))
          ) > (14.4 * 0.001)
          and
          (
            sum(rate(http_requests_total{status=~"5.."}[1h]))
            / sum(rate(http_requests_total[1h]))
          ) > (14.4 * 0.001)
        for: 2m
        labels:
          severity: critical
          team: backend
          slo: availability
        annotations:
          summary: "ã‚¨ãƒ©ãƒ¼ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆãŒå±é™ºæ°´æº– (Critical)"
          description: >
            ç›´è¿‘5åˆ†ã¨1æ™‚é–“ã®ã‚¨ãƒ©ãƒ¼ç‡ãŒSLOãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆã®14.4å€ã‚’è¶…ãˆã¦ã„ã¾ã™ã€‚
            ã“ã®ãƒšãƒ¼ã‚¹ã§ã¯2æ—¥ä»¥å†…ã«æœˆé–“ã‚¨ãƒ©ãƒ¼ãƒã‚¸ã‚§ãƒƒãƒˆã‚’ä½¿ã„åˆ‡ã‚Šã¾ã™ã€‚
          runbook: "https://wiki.example.com/runbooks/high-error-rate"
          dashboard: "https://grafana.example.com/d/slo-overview"
          impact: "å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å½±éŸ¿ã®å¯èƒ½æ€§"

      - alert: HighErrorBurnRate_Warning
        expr: |
          (
            sum(rate(http_requests_total{status=~"5.."}[30m]))
            / sum(rate(http_requests_total[30m]))
          ) > (6 * 0.001)
          and
          (
            sum(rate(http_requests_total{status=~"5.."}[6h]))
            / sum(rate(http_requests_total[6h]))
          ) > (6 * 0.001)
        for: 5m
        labels:
          severity: warning
          team: backend
          slo: availability
        annotations:
          summary: "ã‚¨ãƒ©ãƒ¼ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆãŒè­¦å‘Šæ°´æº– (Warning)"
          description: >
            ç›´è¿‘30åˆ†ã¨6æ™‚é–“ã®ã‚¨ãƒ©ãƒ¼ç‡ãŒSLOãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆã®6å€ã‚’è¶…ãˆã¦ã„ã¾ã™ã€‚
          runbook: "https://wiki.example.com/runbooks/high-error-rate"

      # ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· SLO (p99 < 500ms ã‚’ 99.5% ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§é”æˆ)
      - alert: HighLatencyBurnRate_Critical
        expr: |
          (
            1 - (
              sum(rate(http_request_duration_seconds_bucket{le="0.5"}[5m]))
              / sum(rate(http_request_duration_seconds_count[5m]))
            )
          ) > (14.4 * 0.005)
          and
          (
            1 - (
              sum(rate(http_request_duration_seconds_bucket{le="0.5"}[1h]))
              / sum(rate(http_request_duration_seconds_count[1h]))
            )
          ) > (14.4 * 0.005)
        for: 2m
        labels:
          severity: critical
          team: backend
          slo: latency
        annotations:
          summary: "ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆãŒå±é™ºæ°´æº–"
          description: >
            p99ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãŒ500msã‚’è¶…ãˆã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å‰²åˆãŒæ€¥å¢—ã—ã¦ã„ã¾ã™ã€‚
          runbook: "https://wiki.example.com/runbooks/high-latency"
```

### 2.2 ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆè¨ˆç®—ã®è©³ç´°

```
ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆã‚¢ãƒ©ãƒ¼ãƒˆã®è¨­è¨ˆç†è«–:

SLO: 99.9% (30æ—¥é–“)
ã‚¨ãƒ©ãƒ¼ãƒã‚¸ã‚§ãƒƒãƒˆ: 0.1% = 30æ—¥ Ã— 24æ™‚é–“ Ã— 60åˆ† Ã— 0.001 = 43.2åˆ†

ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆ = å®Ÿéš›ã®ã‚¨ãƒ©ãƒ¼ç‡ / è¨±å®¹ã‚¨ãƒ©ãƒ¼ç‡

  ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆ Ã— ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ â†’ ãƒã‚¸ã‚§ãƒƒãƒˆæ¶ˆè²»
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ãƒãƒ¼ãƒ³   â”‚ ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ â”‚ ãƒã‚¸ã‚§ãƒƒãƒˆå…¨æ¶ˆè²»ã¾ã§ã®    â”‚
  â”‚ ãƒ¬ãƒ¼ãƒˆ   â”‚          â”‚ æ™‚é–“                    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 14.4x   â”‚ 5m + 1h  â”‚ 2æ—¥ (PAGE)             â”‚
  â”‚ 6x      â”‚ 30m + 6h â”‚ 5æ—¥ (TICKET)           â”‚
  â”‚ 3x      â”‚ 2h + 1d  â”‚ 10æ—¥ (NOTIFICATION)    â”‚
  â”‚ 1x      â”‚ 6h + 3d  â”‚ 30æ—¥ (ã¡ã‚‡ã†ã©SLOæ¶ˆè²»)  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Multi-window ã®æ„å‘³:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ çŸ­ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ (5m)                            â”‚
  â”‚   â†’ ç¬é–“çš„ãªã‚¹ãƒ‘ã‚¤ã‚¯ã‚’æ¤œçŸ¥                     â”‚
  â”‚   â†’ å˜ç‹¬ã ã¨ false positive ãŒå¤šã„             â”‚
  â”‚                                               â”‚
  â”‚ é•·ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ (1h)                            â”‚
  â”‚   â†’ æŒç¶šçš„ãªå•é¡Œã‚’ç¢ºèª                         â”‚
  â”‚   â†’ å˜ç‹¬ã ã¨æ¤œçŸ¥ãŒé…ã„                         â”‚
  â”‚                                               â”‚
  â”‚ ä¸¡æ–¹ã® AND æ¡ä»¶                                â”‚
  â”‚   â†’ ç¬é–“ã‚¹ãƒ‘ã‚¤ã‚¯ã‚’é™¤å¤–ã—ã¤ã¤                   â”‚
  â”‚     æŒç¶šçš„ãªå•é¡Œã‚’ç´ æ—©ãæ¤œçŸ¥                    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚¢ãƒ©ãƒ¼ãƒˆ

```yaml
  - name: infrastructure-alerts
    rules:
      - alert: HighMemoryUsage
        expr: |
          (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) > 0.9
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ãŒ90%ã‚’è¶…é"
          description: "{{ $labels.instance }} ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ãŒ {{ $value | humanizePercentage }} ã§ã™"
          runbook: "https://wiki.example.com/runbooks/high-memory"

      - alert: DiskSpaceRunningOut
        expr: |
          predict_linear(node_filesystem_avail_bytes{mountpoint="/"}[6h], 24*3600) < 0
        for: 30m
        labels:
          severity: warning
        annotations:
          summary: "24æ™‚é–“ä»¥å†…ã«ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒæ¯æ¸‡ã™ã‚‹äºˆæ¸¬"
          description: "{{ $labels.instance }} ã®ãƒ‡ã‚£ã‚¹ã‚¯ãŒ24æ™‚é–“ä»¥å†…ã«æº€æ¯ã«ãªã‚Šã¾ã™"
          runbook: "https://wiki.example.com/runbooks/disk-space"

      - alert: DiskSpaceCritical
        expr: |
          (1 - (node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"})) > 0.95
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨ç‡ãŒ95%ã‚’è¶…é"
          description: "{{ $labels.instance }} ã®ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨ç‡ãŒ {{ $value | humanizePercentage }} ã§ã™ã€‚å³æ™‚å¯¾å¿œãŒå¿…è¦ã§ã™ã€‚"
          runbook: "https://wiki.example.com/runbooks/disk-space-critical"

      - alert: HighCPUUsage
        expr: |
          100 - (avg by(instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 90
        for: 15m
        labels:
          severity: warning
        annotations:
          summary: "CPUä½¿ç”¨ç‡ãŒ90%ã‚’è¶…é (15åˆ†é–“æŒç¶š)"
          description: "{{ $labels.instance }} ã®CPUä½¿ç”¨ç‡ãŒ {{ $value }}% ã§ã™"

      # SSL è¨¼æ˜æ›¸ã®æœ‰åŠ¹æœŸé™ãƒã‚§ãƒƒã‚¯
      - alert: SSLCertExpiringSoon
        expr: |
          (probe_ssl_earliest_cert_expiry - time()) / 86400 < 30
        for: 1h
        labels:
          severity: warning
        annotations:
          summary: "SSLè¨¼æ˜æ›¸ã®æœ‰åŠ¹æœŸé™ãŒ30æ—¥ä»¥å†…"
          description: "{{ $labels.instance }} ã®è¨¼æ˜æ›¸ãŒ {{ $value | humanize }}æ—¥å¾Œã«æœŸé™åˆ‡ã‚Œ"

      - alert: SSLCertExpiringSoon_Critical
        expr: |
          (probe_ssl_earliest_cert_expiry - time()) / 86400 < 7
        for: 1h
        labels:
          severity: critical
        annotations:
          summary: "SSLè¨¼æ˜æ›¸ã®æœ‰åŠ¹æœŸé™ãŒ7æ—¥ä»¥å†…"
          description: "{{ $labels.instance }} ã®è¨¼æ˜æ›¸ãŒ {{ $value | humanize }}æ—¥å¾Œã«æœŸé™åˆ‡ã‚Œã§ã™ã€‚å³æ™‚æ›´æ–°ã—ã¦ãã ã•ã„ã€‚"

  - name: kubernetes-alerts
    rules:
      # Pod ãŒ CrashLoopBackOff
      - alert: PodCrashLooping
        expr: |
          rate(kube_pod_container_status_restarts_total[15m]) * 60 * 15 > 3
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "Pod ãŒ CrashLoopBackOff çŠ¶æ…‹"
          description: >
            {{ $labels.namespace }}/{{ $labels.pod }} ãŒ15åˆ†é–“ã«3å›ä»¥ä¸Šå†èµ·å‹•ã—ã¦ã„ã¾ã™ã€‚
          runbook: "https://wiki.example.com/runbooks/pod-crashloop"

      # Deployment ã®ãƒ¬ãƒ—ãƒªã‚«ä¸è¶³
      - alert: DeploymentReplicasMismatch
        expr: |
          kube_deployment_spec_replicas != kube_deployment_status_available_replicas
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "Deployment ã®ãƒ¬ãƒ—ãƒªã‚«æ•°ãŒä¸ä¸€è‡´"
          description: >
            {{ $labels.namespace }}/{{ $labels.deployment }} ã®
            æœŸå¾…ãƒ¬ãƒ—ãƒªã‚«æ•°: {{ $labels.spec_replicas }},
            å®Ÿéš›ã®ãƒ¬ãƒ—ãƒªã‚«æ•°: {{ $value }}

      # Node ã® NotReady çŠ¶æ…‹
      - alert: KubeNodeNotReady
        expr: |
          kube_node_status_condition{condition="Ready", status="true"} == 0
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "Kubernetes Node ãŒ NotReady"
          description: "{{ $labels.node }} ãŒ5åˆ†ä»¥ä¸Š NotReady çŠ¶æ…‹ã§ã™"

      # PersistentVolume ã®å®¹é‡
      - alert: PersistentVolumeRunningOut
        expr: |
          kubelet_volume_stats_available_bytes / kubelet_volume_stats_capacity_bytes < 0.15
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "PersistentVolume ã®ç©ºãå®¹é‡ãŒ15%æœªæº€"
          description: "{{ $labels.namespace }}/{{ $labels.persistentvolumeclaim }} ã®æ®‹ã‚Šå®¹é‡: {{ $value | humanizePercentage }}"

      # HPA ã®ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°é™ç•Œ
      - alert: HPAMaxedOut
        expr: |
          kube_horizontalpodautoscaler_status_current_replicas == kube_horizontalpodautoscaler_spec_max_replicas
        for: 15m
        labels:
          severity: warning
        annotations:
          summary: "HPA ãŒæœ€å¤§ãƒ¬ãƒ—ãƒªã‚«æ•°ã«é”ã—ã¦ã„ã¾ã™"
          description: >
            {{ $labels.namespace }}/{{ $labels.horizontalpodautoscaler }} ãŒ
            æœ€å¤§ãƒ¬ãƒ—ãƒªã‚«æ•° ({{ $value }}) ã§15åˆ†ä»¥ä¸Šå‹•ä½œã—ã¦ã„ã¾ã™ã€‚
            ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ä¸Šé™ã®å¼•ãä¸Šã’ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚
```

### 2.4 ãƒ“ã‚¸ãƒã‚¹ã‚¢ãƒ©ãƒ¼ãƒˆ

```yaml
  - name: business-alerts
    rules:
      # æ³¨æ–‡æ•°ã®æ€¥æ¿€ãªæ¸›å°‘
      - alert: OrderRateDropped
        expr: |
          sum(rate(orders_created_total[30m]))
          < sum(rate(orders_created_total[30m] offset 1d)) * 0.5
        for: 15m
        labels:
          severity: critical
          team: business
        annotations:
          summary: "æ³¨æ–‡æ•°ãŒå‰æ—¥æ¯”50%ä»¥ä¸‹ã«æ€¥æ¸›"
          description: >
            ç›´è¿‘30åˆ†ã®æ³¨æ–‡ãƒ¬ãƒ¼ãƒˆãŒå‰æ—¥åŒæ™‚åˆ»ã¨æ¯”è¼ƒã—ã¦50%ä»¥ä¸‹ã«ä½ä¸‹ã—ã¦ã„ã¾ã™ã€‚
            æ±ºæ¸ˆã‚·ã‚¹ãƒ†ãƒ éšœå®³ã¾ãŸã¯ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰éšœå®³ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
          runbook: "https://wiki.example.com/runbooks/order-rate-drop"

      # æ±ºæ¸ˆæˆåŠŸç‡ã®ä½ä¸‹
      - alert: PaymentSuccessRateLow
        expr: |
          sum(rate(payment_transactions_total{status="success"}[10m]))
          / sum(rate(payment_transactions_total[10m]))
          < 0.95
        for: 5m
        labels:
          severity: critical
          team: payments
        annotations:
          summary: "æ±ºæ¸ˆæˆåŠŸç‡ãŒ95%ã‚’ä¸‹å›ã£ã¦ã„ã¾ã™"
          description: >
            ç›´è¿‘10åˆ†ã®æ±ºæ¸ˆæˆåŠŸç‡: {{ $value | humanizePercentage }}
            æ±ºæ¸ˆãƒ—ãƒ­ãƒã‚¤ãƒ€ã®éšœå®³ã¾ãŸã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒã‚°ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

      # ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã®ç•°å¸¸
      - alert: UserRegistrationAnomaly
        expr: |
          abs(
            sum(rate(user_registrations_total[1h]))
            - sum(rate(user_registrations_total[1h] offset 7d))
          ) / sum(rate(user_registrations_total[1h] offset 7d))
          > 2
        for: 30m
        labels:
          severity: warning
          team: growth
        annotations:
          summary: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²æ•°ã«ç•°å¸¸æ¤œçŸ¥"
          description: "å‰é€±åŒæ™‚åˆ»ã¨æ¯”è¼ƒã—ã¦200%ä»¥ä¸Šã®å¤‰å‹•ãŒã‚ã‚Šã¾ã™"

      # ã‚­ãƒ¥ãƒ¼ã®æ»ç•™
      - alert: QueueBacklogHigh
        expr: |
          sum(queue_messages_pending) by (queue_name) > 10000
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã®æ»ç•™ãŒ10,000ä»¶ã‚’è¶…é"
          description: >
            ã‚­ãƒ¥ãƒ¼ {{ $labels.queue_name }} ã« {{ $value }} ä»¶ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ»ç•™ã—ã¦ã„ã¾ã™ã€‚
            ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒã®ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆã¾ãŸã¯å‡¦ç†é…å»¶ã®èª¿æŸ»ãŒå¿…è¦ã§ã™ã€‚
```

---

## 3. Alertmanager è¨­å®š

### 3.1 ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨é€šçŸ¥è¨­å®š

```yaml
# alertmanager.yml â€” ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
global:
  resolve_timeout: 5m
  slack_api_url: "https://hooks.slack.com/services/XXX/YYY/ZZZ"
  pagerduty_url: "https://events.pagerduty.com/v2/enqueue"

# ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ„ãƒªãƒ¼
route:
  receiver: default-notification
  group_by: ['alertname', 'team', 'service']
  group_wait: 30s       # åŒã˜ã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚’30ç§’å¾…ã£ã¦é›†ç´„
  group_interval: 5m    # åŒã˜ã‚°ãƒ«ãƒ¼ãƒ—ã®å†é€šçŸ¥é–“éš”
  repeat_interval: 4h   # åŒã˜ã‚¢ãƒ©ãƒ¼ãƒˆã®ç¹°ã‚Šè¿”ã—é€šçŸ¥é–“éš”

  routes:
    # Critical â†’ PagerDuty + Slack
    - match:
        severity: critical
      receiver: pagerduty-critical
      continue: true  # æ¬¡ã®ãƒ«ãƒ¼ãƒˆã‚‚è©•ä¾¡
    - match:
        severity: critical
      receiver: slack-critical
      group_wait: 0s  # å³åº§ã«é€šçŸ¥

    # Warning â†’ Slack ã®ã¿
    - match:
        severity: warning
      receiver: slack-warning
      repeat_interval: 12h

    # ãƒãƒ¼ãƒ åˆ¥ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
    - match:
        team: backend
      receiver: slack-backend
    - match:
        team: frontend
      receiver: slack-frontend
    - match:
        team: payments
      receiver: slack-payments
      routes:
        # æ±ºæ¸ˆãƒãƒ¼ãƒ ã® Critical ã¯å°‚ç”¨ PagerDuty ã¸
        - match:
            severity: critical
          receiver: pagerduty-payments

    # ãƒ“ã‚¸ãƒã‚¹ã‚¢ãƒ©ãƒ¼ãƒˆ â†’ ãƒ“ã‚¸ãƒã‚¹ãƒãƒ£ãƒ³ãƒãƒ«
    - match:
        team: business
      receiver: slack-business
      group_wait: 5m

# é€šçŸ¥å…ˆã®å®šç¾©
receivers:
  - name: default-notification
    slack_configs:
      - channel: '#alerts-general'
        send_resolved: true
        title: '{{ .CommonLabels.alertname }}'
        text: '{{ .CommonAnnotations.description }}'

  - name: pagerduty-critical
    pagerduty_configs:
      - routing_key: "YOUR_PAGERDUTY_ROUTING_KEY"
        severity: critical
        description: '{{ .CommonAnnotations.summary }}'
        details:
          alert: '{{ .CommonLabels.alertname }}'
          description: '{{ .CommonAnnotations.description }}'
          runbook: '{{ .CommonAnnotations.runbook }}'
          dashboard: '{{ .CommonAnnotations.dashboard }}'
          num_firing: '{{ .Alerts.Firing | len }}'
        links:
          - href: '{{ .CommonAnnotations.runbook }}'
            text: 'Runbook'
          - href: '{{ .CommonAnnotations.dashboard }}'
            text: 'Dashboard'

  - name: pagerduty-payments
    pagerduty_configs:
      - routing_key: "PAYMENTS_TEAM_ROUTING_KEY"
        severity: critical
        description: '{{ .CommonAnnotations.summary }}'

  - name: slack-critical
    slack_configs:
      - channel: '#alerts-critical'
        color: 'danger'
        title: '{{ .Status | toUpper }}: {{ .CommonLabels.alertname }}'
        text: >-
          *Summary:* {{ .CommonAnnotations.summary }}
          *Description:* {{ .CommonAnnotations.description }}
          *Severity:* {{ .CommonLabels.severity }}
          *Service:* {{ .CommonLabels.service }}
        actions:
          - type: button
            text: 'Runbook'
            url: '{{ .CommonAnnotations.runbook }}'
          - type: button
            text: 'Dashboard'
            url: '{{ .CommonAnnotations.dashboard }}'
          - type: button
            text: 'Silence'
            url: '{{ template "__alertmanagerURL" . }}/#/silences/new?filter=%7Balertname%3D%22{{ .CommonLabels.alertname }}%22%7D'
        send_resolved: true

  - name: slack-warning
    slack_configs:
      - channel: '#alerts-warning'
        color: 'warning'
        title: '{{ .CommonLabels.alertname }}'
        text: '{{ .CommonAnnotations.description }}'
        send_resolved: true

  - name: slack-backend
    slack_configs:
      - channel: '#team-backend-alerts'
        send_resolved: true

  - name: slack-frontend
    slack_configs:
      - channel: '#team-frontend-alerts'
        send_resolved: true

  - name: slack-payments
    slack_configs:
      - channel: '#team-payments-alerts'
        send_resolved: true

  - name: slack-business
    slack_configs:
      - channel: '#business-alerts'
        send_resolved: true

# æŠ‘åˆ¶ãƒ«ãƒ¼ãƒ«
inhibit_rules:
  # Critical ç™ºå ±ä¸­ã¯ Warning ã‚’æŠ‘åˆ¶
  - source_match:
      severity: critical
    target_match:
      severity: warning
    equal: ['alertname', 'team']

  # ã‚µãƒ¼ãƒ“ã‚¹å…¨ä½“ãŒåœæ­¢ä¸­ã¯å€‹åˆ¥ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚’æŠ‘åˆ¶
  - source_match:
      alertname: ServiceDown
    target_match_re:
      alertname: 'High.*BurnRate.*'
    equal: ['service']

  # Node ãŒ NotReady ãªã‚‰ã€ãã® Node ä¸Šã® Pod ã‚¢ãƒ©ãƒ¼ãƒˆã‚’æŠ‘åˆ¶
  - source_match:
      alertname: KubeNodeNotReady
    target_match_re:
      alertname: 'Pod.*'
    equal: ['node']

# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
templates:
  - '/etc/alertmanager/templates/*.tmpl'
```

### 3.2 Alertmanager ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

```go
{{/* /etc/alertmanager/templates/slack.tmpl */}}
{{ define "slack.custom.title" }}
{{ if eq .Status "firing" }}ğŸ”¥{{ else }}âœ…{{ end }} [{{ .Status | toUpper }}] {{ .CommonLabels.alertname }}
{{ end }}

{{ define "slack.custom.text" }}
{{ range .Alerts }}
*Alert:* {{ .Labels.alertname }}
*Severity:* {{ .Labels.severity }}
*Service:* {{ .Labels.service | default "unknown" }}

*Summary:* {{ .Annotations.summary }}
*Description:* {{ .Annotations.description }}

{{ if .Annotations.runbook }}ğŸ“– <{{ .Annotations.runbook }}|Runbook>{{ end }}
{{ if .Annotations.dashboard }}ğŸ“Š <{{ .Annotations.dashboard }}|Dashboard>{{ end }}

*Started:* {{ .StartsAt.Format "2006-01-02 15:04:05 JST" }}
{{ if .EndsAt }}*Ended:* {{ .EndsAt.Format "2006-01-02 15:04:05 JST" }}{{ end }}
---
{{ end }}
{{ end }}

{{ define "slack.custom.footer" }}
Alertmanager | {{ .ExternalURL }}
{{ end }}
```

### 3.3 Silence (ä¸€æ™‚çš„ãªã‚¢ãƒ©ãƒ¼ãƒˆæŠ‘åˆ¶) ã®ç®¡ç†

```bash
#!/bin/bash
# silence-management.sh â€” Alertmanager Silence ã®ç®¡ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ALERTMANAGER_URL="http://alertmanager:9093"

# Silence ã®ä½œæˆ (ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç”¨)
create_maintenance_silence() {
  local duration="${1:-2h}"
  local comment="${2:-Scheduled maintenance}"
  local creator="${3:-sre-team}"

  curl -X POST "${ALERTMANAGER_URL}/api/v2/silences" \
    -H "Content-Type: application/json" \
    -d "{
      \"matchers\": [
        {
          \"name\": \"severity\",
          \"value\": \"warning\",
          \"isRegex\": false,
          \"isEqual\": true
        }
      ],
      \"startsAt\": \"$(date -u +%Y-%m-%dT%H:%M:%S.000Z)\",
      \"endsAt\": \"$(date -u -d \"+${duration}\" +%Y-%m-%dT%H:%M:%S.000Z)\",
      \"createdBy\": \"${creator}\",
      \"comment\": \"${comment}\"
    }"
}

# ç‰¹å®šã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ Silence
silence_alert() {
  local alertname="$1"
  local duration="${2:-1h}"
  local reason="$3"

  curl -X POST "${ALERTMANAGER_URL}/api/v2/silences" \
    -H "Content-Type: application/json" \
    -d "{
      \"matchers\": [
        {
          \"name\": \"alertname\",
          \"value\": \"${alertname}\",
          \"isRegex\": false,
          \"isEqual\": true
        }
      ],
      \"startsAt\": \"$(date -u +%Y-%m-%dT%H:%M:%S.000Z)\",
      \"endsAt\": \"$(date -u -d \"+${duration}\" +%Y-%m-%dT%H:%M:%S.000Z)\",
      \"createdBy\": \"$(whoami)\",
      \"comment\": \"${reason}\"
    }"
}

# ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãª Silence ã®ä¸€è¦§
list_silences() {
  curl -s "${ALERTMANAGER_URL}/api/v2/silences" | \
    jq '.[] | select(.status.state == "active") | {id: .id, createdBy: .createdBy, comment: .comment, endsAt: .endsAt}'
}

# Silence ã®å‰Šé™¤
expire_silence() {
  local silence_id="$1"
  curl -X DELETE "${ALERTMANAGER_URL}/api/v2/silence/${silence_id}"
}
```

---

## 4. ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ­ãƒ¼ã¨ã‚ªãƒ³ã‚³ãƒ¼ãƒ«

### 4.1 ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ­ãƒ¼è©³ç´°

```
ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ­ãƒ¼:

  ã‚¢ãƒ©ãƒ¼ãƒˆç™ºå ±
      â”‚
      â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ è‡ªå‹•å¯¾å¿œå¯èƒ½ï¼Ÿ â”‚â”€â”€â”€â”€ Yes â”€â”€â–º è‡ªå‹•ä¿®å¾© (Auto-remediation)
  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              ä¾‹: Pod å†èµ·å‹•ã€ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ
         â”‚ No
         â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Severity?   â”‚
  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼    â–¼                â–¼
  Critical  Warning     Info
    â”‚       â”‚             â”‚
    â–¼       â–¼             â–¼
  PagerDuty  Slack       Slack
  + Slack    ãƒãƒ£ãƒ³ãƒãƒ«   ãƒãƒ£ãƒ³ãƒãƒ«
    â”‚        (å–¶æ¥­æ™‚é–“)   (è¨˜éŒ²ã®ã¿)
    â–¼
  5åˆ†ä»¥å†…ã«
  å¿œç­”ãªã—ï¼Ÿ
    â”‚
    â–¼
  2æ¬¡ã‚ªãƒ³ã‚³ãƒ¼ãƒ«
  ã¸ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆ
    â”‚
    â–¼
  15åˆ†ä»¥å†…ã«
  å¿œç­”ãªã—ï¼Ÿ
    â”‚
    â–¼
  ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
  ã¸ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆ
    â”‚
    â–¼
  30åˆ†ä»¥å†…ã«
  å¿œç­”ãªã—ï¼Ÿ
    â”‚
    â–¼
  VP/CTO
  ã¸ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆ
```

### 4.2 ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆé‡å¤§åº¦ (SEV) ã®å®šç¾©

```
ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆ SEV ãƒ¬ãƒ™ãƒ«:

â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SEV  â”‚ å®šç¾©           â”‚ ä¾‹            â”‚ å¯¾å¿œæ™‚é–“     â”‚ é€šçŸ¥å…ˆ        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SEV-1â”‚ ã‚µãƒ¼ãƒ“ã‚¹å…¨åœæ­¢  â”‚ å…¨API 500    â”‚ å³æ™‚         â”‚ å…¨ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢  â”‚
â”‚      â”‚ å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼å½±éŸ¿  â”‚ ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±    â”‚ (24/7)       â”‚ + çµŒå–¶å±¤      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SEV-2â”‚ ä¸»è¦æ©Ÿèƒ½åœæ­¢   â”‚ æ±ºæ¸ˆä¸å¯     â”‚ 15åˆ†ä»¥å†…     â”‚ ã‚ªãƒ³ã‚³ãƒ¼ãƒ«    â”‚
â”‚      â”‚ ä¸€éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼   â”‚ æ¤œç´¢ä¸å¯      â”‚ (24/7)       â”‚ + ãƒãƒ¼ãƒ ãƒªãƒ¼ãƒ‰â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SEV-3â”‚ æ©Ÿèƒ½åŠ£åŒ–       â”‚ ãƒ¬ã‚¹ãƒãƒ³ã‚¹é…å»¶â”‚ å–¶æ¥­æ™‚é–“å†…   â”‚ ãƒãƒ¼ãƒ         â”‚
â”‚      â”‚ å›é¿ç­–ã‚ã‚Š     â”‚ UI ãƒã‚°       â”‚ 4æ™‚é–“ä»¥å†…    â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SEV-4â”‚ è»½å¾®ãªå•é¡Œ     â”‚ ãƒ­ã‚°è­¦å‘Š     â”‚ å–¶æ¥­æ™‚é–“å†…   â”‚ ãƒã‚±ãƒƒãƒˆä½œæˆ  â”‚
â”‚      â”‚ ãƒ¦ãƒ¼ã‚¶ãƒ¼å½±éŸ¿ãªã—â”‚ éæœ¬ç•ªç’°å¢ƒ    â”‚ æ¬¡ã‚¹ãƒ—ãƒªãƒ³ãƒˆ â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 PagerDuty / Opsgenie é€£æº

```typescript
// oncall-rotation.ts â€” ã‚ªãƒ³ã‚³ãƒ¼ãƒ«ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­è¨ˆ
interface OncallSchedule {
  team: string;
  rotationType: 'weekly' | 'daily';
  members: string[];
  escalationPolicy: EscalationLevel[];
  overrides: Override[];
  handoffTime: string; // "09:00" (æœˆæ›œæœã«äº¤ä»£)
}

interface EscalationLevel {
  level: number;
  targets: string[];
  timeout: number;  // åˆ†
  notificationChannels: ('phone' | 'sms' | 'push' | 'email')[];
}

interface Override {
  user: string;
  startDate: string;
  endDate: string;
  reason: string;
}

const backendOncall: OncallSchedule = {
  team: 'backend',
  rotationType: 'weekly',
  handoffTime: '09:00',
  members: [
    'engineer-a@example.com',
    'engineer-b@example.com',
    'engineer-c@example.com',
    'engineer-d@example.com',
    'engineer-e@example.com', // æœ€ä½5åã®ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
  ],
  escalationPolicy: [
    {
      level: 1,
      targets: ['current-oncall'],
      timeout: 5,
      notificationChannels: ['push', 'phone'],
    },
    {
      level: 2,
      targets: ['secondary-oncall'],
      timeout: 10,
      notificationChannels: ['push', 'phone', 'sms'],
    },
    {
      level: 3,
      targets: ['engineering-manager'],
      timeout: 15,
      notificationChannels: ['phone', 'sms'],
    },
    {
      level: 4,
      targets: ['vp-engineering'],
      timeout: 30,
      notificationChannels: ['phone'],
    },
  ],
  overrides: [],
};
```

### 4.4 PagerDuty Terraform è¨­å®š

```hcl
# pagerduty.tf â€” PagerDuty ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†
terraform {
  required_providers {
    pagerduty = {
      source  = "PagerDuty/pagerduty"
      version = "~> 3.0"
    }
  }
}

provider "pagerduty" {
  token = var.pagerduty_token
}

# ãƒãƒ¼ãƒ 
resource "pagerduty_team" "backend" {
  name        = "Backend Team"
  description = "Backend engineering team"
}

# ãƒ¦ãƒ¼ã‚¶ãƒ¼
resource "pagerduty_user" "engineers" {
  for_each = toset([
    "engineer-a@example.com",
    "engineer-b@example.com",
    "engineer-c@example.com",
    "engineer-d@example.com",
    "engineer-e@example.com",
  ])

  name  = each.key
  email = each.key
  role  = "user"
}

# ã‚ªãƒ³ã‚³ãƒ¼ãƒ«ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
resource "pagerduty_schedule" "backend_primary" {
  name      = "Backend Primary On-Call"
  time_zone = "Asia/Tokyo"

  layer {
    name                         = "Primary"
    start                        = "2025-01-06T09:00:00+09:00"
    rotation_virtual_start       = "2025-01-06T09:00:00+09:00"
    rotation_turn_length_seconds = 604800  # 1é€±é–“

    users = [for u in pagerduty_user.engineers : u.id]
  }
}

resource "pagerduty_schedule" "backend_secondary" {
  name      = "Backend Secondary On-Call"
  time_zone = "Asia/Tokyo"

  layer {
    name                         = "Secondary"
    start                        = "2025-01-13T09:00:00+09:00"
    rotation_virtual_start       = "2025-01-13T09:00:00+09:00"
    rotation_turn_length_seconds = 604800

    users = [for u in pagerduty_user.engineers : u.id]
  }
}

# ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒªã‚·ãƒ¼
resource "pagerduty_escalation_policy" "backend" {
  name      = "Backend Escalation Policy"
  num_loops = 2  # å…¨ãƒ¬ãƒ™ãƒ«2å›ç¹°ã‚Šè¿”ã—

  rule {
    escalation_delay_in_minutes = 5
    target {
      type = "schedule_reference"
      id   = pagerduty_schedule.backend_primary.id
    }
  }

  rule {
    escalation_delay_in_minutes = 10
    target {
      type = "schedule_reference"
      id   = pagerduty_schedule.backend_secondary.id
    }
  }

  rule {
    escalation_delay_in_minutes = 15
    target {
      type = "user_reference"
      id   = pagerduty_user.engineers["engineer-a@example.com"].id  # EM
    }
  }
}

# ã‚µãƒ¼ãƒ“ã‚¹
resource "pagerduty_service" "order_service" {
  name                    = "Order Service"
  description             = "Order processing service"
  escalation_policy       = pagerduty_escalation_policy.backend.id
  auto_resolve_timeout    = 14400  # 4æ™‚é–“ã§è‡ªå‹•è§£æ±º
  acknowledgement_timeout = 600    # 10åˆ†ã§ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆ

  alert_creation = "create_alerts_and_incidents"

  incident_urgency_rule {
    type    = "constant"
    urgency = "high"
  }

  auto_pause_notifications_parameters {
    enabled = true
    timeout = 300  # 5åˆ†é–“ã®ãƒ•ãƒ©ãƒƒãƒ”ãƒ³ã‚°é˜²æ­¢
  }
}

# ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆ (Prometheus Alertmanager â†’ PagerDuty)
resource "pagerduty_service_integration" "prometheus" {
  name    = "Prometheus Alertmanager"
  service = pagerduty_service.order_service.id
  vendor  = data.pagerduty_vendor.prometheus.id
}

data "pagerduty_vendor" "prometheus" {
  name = "Prometheus"
}
```

---

## 5. è‡ªå‹•ä¿®å¾© (Auto-remediation)

### 5.1 Kubernetes CronJob ã«ã‚ˆã‚‹è‡ªå‹•ä¿®å¾©

```yaml
# auto-remediation.yml â€” è‡ªå‹•ä¿®å¾©ã‚¸ãƒ§ãƒ–
apiVersion: batch/v1
kind: CronJob
metadata:
  name: cleanup-stuck-pods
  namespace: monitoring
spec:
  schedule: "*/5 * * * *"  # 5åˆ†ã”ã¨
  jobTemplate:
    spec:
      template:
        spec:
          serviceAccountName: auto-remediation
          containers:
            - name: remediation
              image: bitnami/kubectl:latest
              command:
                - /bin/bash
                - -c
                - |
                  # CrashLoopBackOff ã® Pod ã‚’æ¤œå‡ºã—ã¦å‰Šé™¤
                  kubectl get pods --all-namespaces -o json | \
                    jq -r '.items[] |
                      select(.status.containerStatuses[]?.state.waiting.reason == "CrashLoopBackOff") |
                      select(.status.containerStatuses[]?.restartCount > 10) |
                      "\(.metadata.namespace) \(.metadata.name)"' | \
                  while read namespace pod; do
                    echo "Deleting CrashLoopBackOff pod: ${namespace}/${pod}"
                    kubectl delete pod -n "${namespace}" "${pod}" --grace-period=0
                  done

                  # Evicted Pod ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
                  kubectl get pods --all-namespaces --field-selector=status.phase=Failed -o json | \
                    jq -r '.items[] | select(.status.reason == "Evicted") | "\(.metadata.namespace) \(.metadata.name)"' | \
                  while read namespace pod; do
                    echo "Cleaning up evicted pod: ${namespace}/${pod}"
                    kubectl delete pod -n "${namespace}" "${pod}"
                  done
          restartPolicy: OnFailure
```

### 5.2 Alertmanager Webhook ã«ã‚ˆã‚‹è‡ªå‹•ä¿®å¾©

```typescript
// auto-remediation-webhook.ts â€” ã‚¢ãƒ©ãƒ¼ãƒˆã«åŸºã¥ãè‡ªå‹•ä¿®å¾©
import express from 'express';
import { KubernetesObjectApi, KubeConfig } from '@kubernetes/client-node';

const app = express();
app.use(express.json());

interface AlertmanagerWebhook {
  status: 'firing' | 'resolved';
  alerts: {
    status: string;
    labels: Record<string, string>;
    annotations: Record<string, string>;
  }[];
}

// è‡ªå‹•ä¿®å¾©ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å®šç¾©
const remediationActions: Record<string, (alert: any) => Promise<void>> = {
  // Pod ã®å†èµ·å‹•
  PodCrashLooping: async (alert) => {
    const namespace = alert.labels.namespace;
    const pod = alert.labels.pod;
    console.log(`Auto-remediation: Restarting pod ${namespace}/${pod}`);

    const kc = new KubeConfig();
    kc.loadFromDefault();
    const k8sApi = kc.makeApiClient(KubernetesObjectApi);

    await k8sApi.delete({
      apiVersion: 'v1',
      kind: 'Pod',
      metadata: { name: pod, namespace: namespace },
    });

    // Slack é€šçŸ¥
    await notifySlack(`è‡ªå‹•ä¿®å¾©: Pod ${namespace}/${pod} ã‚’å†èµ·å‹•ã—ã¾ã—ãŸ`);
  },

  // HPA ã®ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ
  HPAMaxedOut: async (alert) => {
    const namespace = alert.labels.namespace;
    const hpaName = alert.labels.horizontalpodautoscaler;
    console.log(`Auto-remediation: Scaling up HPA ${namespace}/${hpaName}`);

    const kc = new KubeConfig();
    kc.loadFromDefault();
    const k8sApi = kc.makeApiClient(KubernetesObjectApi);

    // æœ€å¤§ãƒ¬ãƒ—ãƒªã‚«æ•°ã‚’ 50% å¢—åŠ 
    const hpa = await k8sApi.read({
      apiVersion: 'autoscaling/v2',
      kind: 'HorizontalPodAutoscaler',
      metadata: { name: hpaName, namespace: namespace },
    });

    const currentMax = (hpa.body as any).spec.maxReplicas;
    const newMax = Math.ceil(currentMax * 1.5);

    await k8sApi.patch({
      apiVersion: 'autoscaling/v2',
      kind: 'HorizontalPodAutoscaler',
      metadata: { name: hpaName, namespace: namespace },
    }, [
      { op: 'replace', path: '/spec/maxReplicas', value: newMax },
    ]);

    await notifySlack(
      `è‡ªå‹•ä¿®å¾©: HPA ${namespace}/${hpaName} ã®æœ€å¤§ãƒ¬ãƒ—ãƒªã‚«æ•°ã‚’ ${currentMax} â†’ ${newMax} ã«å¤‰æ›´ã—ã¾ã—ãŸ`
    );
  },

  // ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
  DiskSpaceCritical: async (alert) => {
    const instance = alert.labels.instance;
    console.log(`Auto-remediation: Cleaning disk on ${instance}`);

    // SSH çµŒç”±ã§ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— (å®Ÿéš›ã¯ Ansible / SSM çµŒç”±)
    // å¤ã„ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤
    // Docker ã®æœªä½¿ç”¨ã‚¤ãƒ¡ãƒ¼ã‚¸ã®å‰Šé™¤
    await notifySlack(
      `è‡ªå‹•ä¿®å¾©: ${instance} ã®ãƒ‡ã‚£ã‚¹ã‚¯ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚’å®Ÿè¡Œã—ã¾ã—ãŸ`
    );
  },
};

// Webhook ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
app.post('/webhook/alertmanager', async (req, res) => {
  const payload: AlertmanagerWebhook = req.body;

  for (const alert of payload.alerts) {
    if (alert.status !== 'firing') continue;

    const alertName = alert.labels.alertname;
    const action = remediationActions[alertName];

    if (action) {
      try {
        await action(alert);
        console.log(`Remediation succeeded for ${alertName}`);
      } catch (error) {
        console.error(`Remediation failed for ${alertName}:`, error);
        await notifySlack(
          `è‡ªå‹•ä¿®å¾©å¤±æ•—: ${alertName} â€” ${(error as Error).message}`
        );
      }
    }
  }

  res.status(200).send('ok');
});

async function notifySlack(message: string): Promise<void> {
  await fetch(process.env.SLACK_WEBHOOK_URL!, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      channel: '#auto-remediation',
      text: message,
    }),
  });
}

app.listen(8080, () => {
  console.log('Auto-remediation webhook listening on :8080');
});
```

---

## 6. ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

### 6.1 ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

```markdown
<!-- postmortem-template.md -->
# ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ : [ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚¿ã‚¤ãƒˆãƒ«]

## æ¦‚è¦
- **æ—¥æ™‚**: 2025-03-15 14:30 ã€œ 15:45 JST (75åˆ†é–“)
- **å½±éŸ¿ç¯„å›²**: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ±ºæ¸ˆå‡¦ç†ãŒä¸å¯
- **å½±éŸ¿åº¦**: SEV-1 (ã‚µãƒ¼ãƒ“ã‚¹å…¨ä½“ã®é‡å¤§éšœå®³)
- **æ¤œçŸ¥æ–¹æ³•**: SLO ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆã‚¢ãƒ©ãƒ¼ãƒˆ (è‡ªå‹•æ¤œçŸ¥)
- **å¯¾å¿œè€…**: @engineer-a (1æ¬¡), @engineer-b (æ”¯æ´)
- **ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚³ãƒãƒ³ãƒ€ãƒ¼**: @engineer-a

## ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³
| æ™‚åˆ» | ã‚¤ãƒ™ãƒ³ãƒˆ |
|------|---------|
| 14:30 | ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº† (v2.5.0) |
| 14:32 | ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ¼ãƒˆæ€¥ä¸Šæ˜‡ã€ã‚¢ãƒ©ãƒ¼ãƒˆç™ºå ± |
| 14:35 | ã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“ãŒã‚¢ã‚¯ãƒãƒ¬ãƒƒã‚¸ |
| 14:38 | Slack ã® #incident-20250315 ãƒãƒ£ãƒ³ãƒãƒ«ä½œæˆ |
| 14:40 | æ±ºæ¸ˆ API ã® 500 ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª |
| 14:45 | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸ã‚’ã€ŒDegradedã€ã«æ›´æ–° |
| 14:50 | åŸå› ç‰¹å®š: DB ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§æ±ºæ¸ˆãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ åå¤‰æ›´ |
| 15:00 | ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯é–‹å§‹ (v2.4.3 ã¸) |
| 15:15 | ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Œäº†ã€ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ¼ãƒˆæ­£å¸¸åŒ– |
| 15:30 | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸ã‚’ã€ŒOperationalã€ã«æ›´æ–° |
| 15:45 | å…¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹æ­£å¸¸ã‚’ç¢ºèªã€ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚¯ãƒ­ãƒ¼ã‚º |

## æ ¹æœ¬åŸå› 
DB ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ `payment_status` ã‚«ãƒ©ãƒ ã‚’ `status` ã«ãƒªãƒãƒ¼ãƒ ã—ãŸãŒã€
æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚³ãƒ¼ãƒ‰ãŒ `payment_status` ã‚’å‚ç…§ã—ã¦ã„ãŸã€‚
Rolling Update ä¸­ã«æ–°æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæ··åœ¨ã—ã€æ—§ã‚³ãƒ¼ãƒ‰ãŒã‚«ãƒ©ãƒ æœªæ¤œå‡ºã‚¨ãƒ©ãƒ¼ã‚’èµ·ã“ã—ãŸã€‚

## å½±éŸ¿ã®å®šé‡åŒ–
- å½±éŸ¿ã‚’å—ã‘ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°: ç´„ 3,200 å
- å¤±æ•—ã—ãŸãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³: 847 ä»¶
- æ¨å®šå£²ä¸Šæå¤±: Â¥4,235,000
- SLO ã‚¨ãƒ©ãƒ¼ãƒã‚¸ã‚§ãƒƒãƒˆæ¶ˆè²»: æœˆé–“ãƒã‚¸ã‚§ãƒƒãƒˆã® 12.3%

## 5 Whys åˆ†æ
1. **Why** æ±ºæ¸ˆãŒå¤±æ•—ã—ãŸï¼Ÿ â†’ ã‚«ãƒ©ãƒ åã®ä¸ä¸€è‡´
2. **Why** ã‚«ãƒ©ãƒ åãŒä¸ä¸€è‡´ï¼Ÿ â†’ ç ´å£Šçš„å¤‰æ›´ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
3. **Why** ç ´å£Šçš„å¤‰æ›´ãŒæœ¬ç•ªé©ç”¨ã•ã‚ŒãŸï¼Ÿ â†’ Expand-Contract ãƒ‘ã‚¿ãƒ¼ãƒ³æœªä½¿ç”¨
4. **Why** ãƒ‘ã‚¿ãƒ¼ãƒ³æœªä½¿ç”¨ï¼Ÿ â†’ DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ãŒãªã„
5. **Why** ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ãŒãªã„ï¼Ÿ â†’ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆ¦ç•¥ã®æ–‡æ›¸åŒ–ãŒæœªå®Ÿæ–½

## å†ç™ºé˜²æ­¢ç­–
| ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | æ‹…å½“ | æœŸé™ | å„ªå…ˆåº¦ | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
|-----------|------|------|--------|-----------|
| DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®Expand-Contractãƒ‘ã‚¿ãƒ¼ãƒ³å¿…é ˆåŒ– | @engineer-a | 2025-03-22 | P0 | å®Œäº† |
| ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®è‡ªå‹• Smoke Test ã‚’è¿½åŠ  | @engineer-b | 2025-03-29 | P1 | é€²è¡Œä¸­ |
| ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †ã‚’è‡ªå‹•åŒ– | @engineer-c | 2025-04-05 | P1 | æœªç€æ‰‹ |
| DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã®æ–‡æ›¸åŒ– | @engineer-a | 2025-04-12 | P1 | æœªç€æ‰‹ |
| ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®è‡ªå‹•äº’æ›æ€§ãƒã‚§ãƒƒã‚¯ (CI) | @engineer-d | 2025-04-19 | P2 | æœªç€æ‰‹ |

## æ•™è¨“
- ç ´å£Šçš„ãª DB å¤‰æ›´ã¯ Expand-Contract ãƒ‘ã‚¿ãƒ¼ãƒ³ã§æ®µéšçš„ã«è¡Œã†
- ãƒ‡ãƒ—ãƒ­ã‚¤ç›´å¾Œã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç›£è¦–æœŸé–“ã‚’è¨­ã‘ã‚‹ (æœ€ä½10åˆ†)
- ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯åˆ¤æ–­ã®åŸºæº–ã‚’äº‹å‰ã«å®šç¾©ã—ã¦ãŠã
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸ã®æ›´æ–°ã‚’è¿…é€Ÿã«è¡Œã„ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®å½±éŸ¿ã‚’é€æ˜åŒ–ã™ã‚‹

## ã†ã¾ãã„ã£ãŸã“ã¨
- SLO ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆã‚¢ãƒ©ãƒ¼ãƒˆãŒ2åˆ†ä»¥å†…ã«æ¤œçŸ¥ã—ãŸ
- ã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“ãŒ3åˆ†ä»¥å†…ã«ã‚¢ã‚¯ãƒãƒ¬ãƒƒã‚¸ã—ãŸ
- ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯è‡ªä½“ã¯15åˆ†ã§å®Œäº†ã—ãŸ (æ‰‹é †ãŒæ•´å‚™ã•ã‚Œã¦ã„ãŸ)
```

### 6.2 ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ãƒ—ãƒ­ã‚»ã‚¹

```
ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã®é‹ç”¨ãƒ—ãƒ­ã‚»ã‚¹:

  ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç™ºç”Ÿ
      â”‚
      â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ   â”‚  â† ä»Šã¯å¯¾å¿œã«é›†ä¸­ã€‚è¨˜éŒ²ã¯å¾Œã§ã€‚
  â”‚ (å¾©æ—§æœ€å„ªå…ˆ)      â”‚
  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ å¾©æ—§å®Œäº†
         â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ 48æ™‚é–“ä»¥å†…ã«       â”‚
  â”‚ ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ä½œæˆ â”‚  â† è¨˜æ†¶ãŒæ–°ã—ã„ã†ã¡ã«
  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ      â”‚  â† é–¢ä¿‚è€…å…¨å“¡å‚åŠ 
  â”‚ ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°â”‚     blame-free ã®åŸå‰‡
  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     30-60åˆ†
         â”‚
         â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ  â”‚  â† Jira / Linear ãƒã‚±ãƒƒãƒˆåŒ–
  â”‚ ã®ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°     â”‚     æœŸé™ã¨æ‹…å½“è€…ã‚’æ˜ç¢ºã«
  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ æœˆæ¬¡ã‚¢ãƒ©ãƒ¼ãƒˆ       â”‚  â† ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Œäº†ã®ç¢ºèª
  â”‚ ãƒ¬ãƒ“ãƒ¥ãƒ¼           â”‚     æ–°ãŸãªã‚¢ãƒ©ãƒ¼ãƒˆã®è©•ä¾¡
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã® GitHub Issue è‡ªå‹•ç”Ÿæˆ

```yaml
# .github/workflows/create-postmortem.yml
name: Create Postmortem Issue

on:
  workflow_dispatch:
    inputs:
      incident_title:
        description: 'ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®ã‚¿ã‚¤ãƒˆãƒ«'
        required: true
      severity:
        description: 'SEV ãƒ¬ãƒ™ãƒ«'
        required: true
        type: choice
        options: ['SEV-1', 'SEV-2', 'SEV-3']
      start_time:
        description: 'é–‹å§‹æ™‚åˆ» (JST)'
        required: true
      end_time:
        description: 'çµ‚äº†æ™‚åˆ» (JST)'
        required: true
      incident_commander:
        description: 'ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚³ãƒãƒ³ãƒ€ãƒ¼ (GitHub username)'
        required: true

jobs:
  create-issue:
    runs-on: ubuntu-latest
    steps:
      - name: Create Postmortem Issue
        uses: actions/github-script@v7
        with:
          script: |
            const body = `# ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ : ${{ inputs.incident_title }}

            ## æ¦‚è¦
            - **æ—¥æ™‚**: ${{ inputs.start_time }} ã€œ ${{ inputs.end_time }} JST
            - **å½±éŸ¿åº¦**: ${{ inputs.severity }}
            - **ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚³ãƒãƒ³ãƒ€ãƒ¼**: @${{ inputs.incident_commander }}

            ## ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³
            | æ™‚åˆ» | ã‚¤ãƒ™ãƒ³ãƒˆ |
            |------|---------|
            | | |

            ## æ ¹æœ¬åŸå› 
            _ï¼ˆè¨˜å…¥ã—ã¦ãã ã•ã„ï¼‰_

            ## å½±éŸ¿ã®å®šé‡åŒ–
            - å½±éŸ¿ã‚’å—ã‘ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°:
            - å¤±æ•—ã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°:
            - SLO ã‚¨ãƒ©ãƒ¼ãƒã‚¸ã‚§ãƒƒãƒˆæ¶ˆè²»:

            ## 5 Whys åˆ†æ
            1. **Why**
            2. **Why**
            3. **Why**
            4. **Why**
            5. **Why**

            ## å†ç™ºé˜²æ­¢ç­–
            | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | æ‹…å½“ | æœŸé™ | å„ªå…ˆåº¦ |
            |-----------|------|------|--------|
            | | | | |

            ## æ•™è¨“
            -

            ## ã†ã¾ãã„ã£ãŸã“ã¨
            -

            ---
            **æœŸé™: ${new Date(Date.now() + 48 * 60 * 60 * 1000).toISOString().split('T')[0]} (48æ™‚é–“ä»¥å†…ã«å®Œæˆ)**
            `;

            const issue = await github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: `[Postmortem] ${{ inputs.incident_title }}`,
              body: body,
              labels: ['postmortem', '${{ inputs.severity }}'],
              assignees: ['${{ inputs.incident_commander }}'],
            });

            console.log(`Created postmortem issue: ${issue.data.html_url}`);
```

---

## 7. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œãƒ—ãƒ­ã‚»ã‚¹

### 7.1 ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚³ãƒãƒ³ãƒ€ãƒ¼ (IC) ã®å½¹å‰²

```
ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚³ãƒãƒ³ãƒ€ãƒ¼ã®è²¬å‹™:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                    â”‚
â”‚  1. çŠ¶æ³æŠŠæ¡ (Assess)                              â”‚
â”‚     ãƒ»å½±éŸ¿ç¯„å›²ã®ç¢ºèª                               â”‚
â”‚     ãƒ»SEV ãƒ¬ãƒ™ãƒ«ã®åˆ¤å®š                             â”‚
â”‚     ãƒ»å¯¾å¿œãƒãƒ¼ãƒ ã®æ‹›é›†                             â”‚
â”‚                                                    â”‚
â”‚  2. ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ (Communicate)               â”‚
â”‚     ãƒ»#incident ãƒãƒ£ãƒ³ãƒãƒ«ã®ä½œæˆ                    â”‚
â”‚     ãƒ»å®šæœŸçš„ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–° (15åˆ†ã”ã¨)             â”‚
â”‚     ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸ã®æ›´æ–°                       â”‚
â”‚     ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼ã¸ã®å ±å‘Š                     â”‚
â”‚                                                    â”‚
â”‚  3. å§”ä»» (Delegate)                                â”‚
â”‚     ãƒ»èª¿æŸ»æ‹…å½“ã®æŒ‡å                               â”‚
â”‚     ãƒ»å¯¾å¤–ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ‹…å½“ã®æŒ‡å             â”‚
â”‚     ãƒ»è‡ªèº«ã¯èª¿æŸ»ã«æ²¡é ­ã—ãªã„ (æŒ‡æ®ã«å°‚å¿µ)          â”‚
â”‚                                                    â”‚
â”‚  4. æ„æ€æ±ºå®š (Decide)                              â”‚
â”‚     ãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®åˆ¤æ–­                           â”‚
â”‚     ãƒ»ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ¤æ–­                       â”‚
â”‚     ãƒ»ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚¯ãƒ­ãƒ¼ã‚ºã®åˆ¤æ–­                   â”‚
â”‚                                                    â”‚
â”‚  5. è¨˜éŒ² (Record)                                  â”‚
â”‚     ãƒ»ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã®è¨˜éŒ²                           â”‚
â”‚     ãƒ»ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã®æ‰‹é…                         â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

```
â–¡ ã‚¢ãƒ©ãƒ¼ãƒˆã®ç¢ºèªã¨ã‚¢ã‚¯ãƒãƒ¬ãƒƒã‚¸
  â””â”€ PagerDuty/Opsgenie ã§ã‚¢ã‚¯ãƒãƒ¬ãƒƒã‚¸
  â””â”€ ã‚¢ãƒ©ãƒ¼ãƒˆã®å†…å®¹ã‚’ç¢ºèª

â–¡ åˆæœŸè©•ä¾¡ (æœ€åˆã®5åˆ†)
  â””â”€ å½±éŸ¿ç¯„å›²ã‚’ç¢ºèª
  â””â”€ SEV ãƒ¬ãƒ™ãƒ«ã‚’åˆ¤å®š
  â””â”€ Runbook ã‚’ç¢ºèª

â–¡ ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹
  â””â”€ #incident-YYYYMMDD ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ä½œæˆ
  â””â”€ IC (ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚³ãƒãƒ³ãƒ€ãƒ¼) ã‚’å®£è¨€
  â””â”€ åˆæœŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æŠ•ç¨¿

â–¡ èª¿æŸ»ã¨å¯¾å¿œ
  â””â”€ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰/ãƒ­ã‚°/ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ç¢ºèª
  â””â”€ ç›´è¿‘ã®å¤‰æ›´ (ãƒ‡ãƒ—ãƒ­ã‚¤ã€è¨­å®šå¤‰æ›´) ã‚’ç¢ºèª
  â””â”€ åŸå› ã®ä»®èª¬ã‚’ç«‹ã¦ã¦æ¤œè¨¼

â–¡ ç·©å’Œç­–ã®å®Ÿè¡Œ
  â””â”€ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ / ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ / ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼
  â””â”€ å½±éŸ¿ã®è»½æ¸›ç­–ã‚’å®Ÿè¡Œ

â–¡ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸ã®æ›´æ–°
  â””â”€ SEV-1/2: 15åˆ†ã”ã¨ã«æ›´æ–°
  â””â”€ SEV-3: 1æ™‚é–“ã”ã¨ã«æ›´æ–°

â–¡ å¾©æ—§ç¢ºèª
  â””â”€ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒæ­£å¸¸ç¯„å›²ã«æˆ»ã£ãŸã“ã¨ã‚’ç¢ºèª
  â””â”€ ãƒ¦ãƒ¼ã‚¶ãƒ¼å½±éŸ¿ãŒãªããªã£ãŸã“ã¨ã‚’ç¢ºèª
  â””â”€ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸ã‚’ã€ŒOperationalã€ã«æ›´æ–°

â–¡ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚¯ãƒ­ãƒ¼ã‚º
  â””â”€ #incident ãƒãƒ£ãƒ³ãƒãƒ«ã«ã‚¯ãƒ­ãƒ¼ã‚ºã‚’å®£è¨€
  â””â”€ ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ä½œæˆã®æ‰‹é… (48æ™‚é–“ä»¥å†…)
  â””â”€ é–¢ä¿‚è€…ã¸ã®æœ€çµ‚å ±å‘Š
```

### 7.3 ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸ã®é‹ç”¨

```typescript
// statuspage-updater.ts â€” ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸ã®è‡ªå‹•æ›´æ–°
import fetch from 'node-fetch';

interface StatusPageConfig {
  apiKey: string;
  pageId: string;
  componentMap: Record<string, string>; // service name â†’ component ID
}

class StatusPageUpdater {
  constructor(private config: StatusPageConfig) {}

  // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°
  async updateComponentStatus(
    serviceName: string,
    status: 'operational' | 'degraded_performance' | 'partial_outage' | 'major_outage'
  ): Promise<void> {
    const componentId = this.config.componentMap[serviceName];
    if (!componentId) throw new Error(`Unknown service: ${serviceName}`);

    await fetch(
      `https://api.statuspage.io/v1/pages/${this.config.pageId}/components/${componentId}`,
      {
        method: 'PATCH',
        headers: {
          'Authorization': `OAuth ${this.config.apiKey}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          component: { status },
        }),
      }
    );
  }

  // ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®ä½œæˆ
  async createIncident(
    name: string,
    body: string,
    impactOverride: 'none' | 'minor' | 'major' | 'critical',
    componentIds: string[],
    componentStatus: string
  ): Promise<string> {
    const response = await fetch(
      `https://api.statuspage.io/v1/pages/${this.config.pageId}/incidents`,
      {
        method: 'POST',
        headers: {
          'Authorization': `OAuth ${this.config.apiKey}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          incident: {
            name,
            body,
            status: 'investigating',
            impact_override: impactOverride,
            component_ids: componentIds,
            components: Object.fromEntries(
              componentIds.map(id => [id, componentStatus])
            ),
          },
        }),
      }
    );

    const data = await response.json() as any;
    return data.id;
  }

  // ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®æ›´æ–°
  async updateIncident(
    incidentId: string,
    status: 'investigating' | 'identified' | 'monitoring' | 'resolved',
    body: string
  ): Promise<void> {
    await fetch(
      `https://api.statuspage.io/v1/pages/${this.config.pageId}/incidents/${incidentId}`,
      {
        method: 'PATCH',
        headers: {
          'Authorization': `OAuth ${this.config.apiKey}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          incident: {
            status,
            body,
          },
        }),
      }
    );
  }
}

// ä½¿ç”¨ä¾‹
const statusPage = new StatusPageUpdater({
  apiKey: process.env.STATUSPAGE_API_KEY!,
  pageId: 'your-page-id',
  componentMap: {
    'order-service': 'component-id-1',
    'payment-service': 'component-id-2',
    'user-service': 'component-id-3',
  },
});

// ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç™ºç”Ÿæ™‚
const incidentId = await statusPage.createIncident(
  'æ±ºæ¸ˆå‡¦ç†ã®é…å»¶',
  'æ±ºæ¸ˆå‡¦ç†ã«é€šå¸¸ã‚ˆã‚Šæ™‚é–“ãŒã‹ã‹ã£ã¦ã„ã¾ã™ã€‚èª¿æŸ»ä¸­ã§ã™ã€‚',
  'major',
  ['component-id-2'],
  'degraded_performance'
);

// åŸå› ç‰¹å®šå¾Œ
await statusPage.updateIncident(
  incidentId,
  'identified',
  'æ±ºæ¸ˆãƒ—ãƒ­ãƒã‚¤ãƒ€å´ã®ä¸€æ™‚çš„ãªéšœå®³ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚å¾©æ—§ã‚’å¾…ã£ã¦ã„ã¾ã™ã€‚'
);

// å¾©æ—§å¾Œ
await statusPage.updateIncident(
  incidentId,
  'resolved',
  'æ±ºæ¸ˆãƒ—ãƒ­ãƒã‚¤ãƒ€ã®éšœå®³ãŒå¾©æ—§ã—ã€å…¨ã‚µãƒ¼ãƒ“ã‚¹ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™ã€‚'
);
```

---

## 8. æ¯”è¼ƒè¡¨

| ã‚¢ãƒ©ãƒ¼ãƒˆãƒ„ãƒ¼ãƒ« | Alertmanager | PagerDuty | Opsgenie | Datadog Monitors |
|--------------|-------------|-----------|----------|-----------------|
| é‹ç”¨å½¢æ…‹ | OSS | SaaS | SaaS | SaaS |
| ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ | åŸºæœ¬çš„ | é«˜åº¦ | é«˜åº¦ | åŸºæœ¬çš„ |
| ã‚ªãƒ³ã‚³ãƒ¼ãƒ«ç®¡ç† | ãªã— (å¤–éƒ¨é€£æº) | å……å®Ÿ | å……å®Ÿ | ãªã— (å¤–éƒ¨é€£æº) |
| ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒª | ãªã— | ã‚ã‚Š | ã‚ã‚Š | ã‚ã‚Š |
| ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç† | ãªã— | ã‚ã‚Š | ã‚ã‚Š | ã‚ã‚Š |
| è‡ªå‹•ä¿®å¾© | Webhook | Event Orchestration | Webhook | Workflow Automation |
| æ–™é‡‘ | ç„¡æ–™ | $21/user/æœˆã€œ | $9/user/æœˆã€œ | å«ã‚€ |
| Terraform | å¯¾å¿œ | å¯¾å¿œ | å¯¾å¿œ | å¯¾å¿œ |

| ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ãƒ„ãƒ¼ãƒ« | Google Docs | Jeli | incident.io | Notion | GitHub Issues |
|--------------------|------------|------|-------------|--------|---------------|
| ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç† | æ‰‹å‹• | è‡ªå‹• | è‡ªå‹• | æ‰‹å‹• | è‡ªå‹• (Actions) |
| ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è‡ªå‹•ç”Ÿæˆ | ä¸å¯ | å¯¾å¿œ | å¯¾å¿œ | ä¸å¯ | ä¸å¯ |
| ãƒ¡ãƒˆãƒªã‚¯ã‚¹åŸ‹ã‚è¾¼ã¿ | ä¸å¯ | å¯¾å¿œ | å¯¾å¿œ | ä¸å¯ | ä¸å¯ |
| ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¿½è·¡ | ä¸å¯ | å¯¾å¿œ | å¯¾å¿œ | æ‰‹å‹• | Issue é€£æº |
| Slack çµ±åˆ | ä¸å¯ | å¯¾å¿œ | å¯¾å¿œ | å¯¾å¿œ | å¯¾å¿œ |
| ã‚³ã‚¹ãƒˆ | ç„¡æ–™ | æœ‰æ–™ | æœ‰æ–™ | ç„¡æ–™/æœ‰æ–™ | ç„¡æ–™ |

| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸ | Statuspage | Instatus | Cachet | Better Uptime |
|----------------|-----------|----------|--------|--------------|
| é‹ç”¨å½¢æ…‹ | SaaS | SaaS | OSS | SaaS |
| API å¯¾å¿œ | å……å®Ÿ | å¯¾å¿œ | å¯¾å¿œ | å¯¾å¿œ |
| è‡ªå‹•ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–° | å¯¾å¿œ | å¯¾å¿œ | é™å®šçš„ | å¯¾å¿œ |
| ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ | å¯¾å¿œ | å¯¾å¿œ | å¯¾å¿œ | å¯¾å¿œ |
| æ–™é‡‘ | $29/æœˆã€œ | $20/æœˆã€œ | ç„¡æ–™ | $20/æœˆã€œ |

---

## 9. ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³

### ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ 1: ã‚¢ãƒ©ãƒ¼ãƒˆç–²ã‚Œ (Alert Fatigue)

```
[æ‚ªã„ä¾‹]
- 1æ—¥ã«50ä»¶ä»¥ä¸Šã®ã‚¢ãƒ©ãƒ¼ãƒˆãŒç™ºå ±
- å¤§åŠãŒã€Œå¯¾å¿œä¸è¦ã€ã§ç„¡è¦–ã•ã‚Œã‚‹
- æœ¬å½“ã«é‡è¦ãªã‚¢ãƒ©ãƒ¼ãƒˆã‚‚è¦‹é€ƒã•ã‚Œã‚‹
- ã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“ãŒç–²å¼Šã—é›¢è·

[è‰¯ã„ä¾‹]
- ã‚¢ãƒ©ãƒ¼ãƒˆã¯ã€Œä»Šã™ãäººé–“ãŒå¯¾å¿œã™ã¹ãã‚‚ã®ã€ã«é™å®š
- æœˆæ¬¡ã§ã‚¢ãƒ©ãƒ¼ãƒˆã‚’æ£šå¸ã—:
  - å¯¾å¿œä¸è¦ã§ç„¡è¦–ã—ãŸã‚¢ãƒ©ãƒ¼ãƒˆ â†’ å‰Šé™¤ã¾ãŸã¯ã—ãã„å€¤èª¿æ•´
  - è‡ªå‹•å¾©æ—§ã§ãã‚‹ã‚¢ãƒ©ãƒ¼ãƒˆ â†’ è‡ªå‹•ä¿®å¾©ã«å¤‰æ›´
  - é »ç™ºã™ã‚‹ã‚¢ãƒ©ãƒ¼ãƒˆ â†’ æ ¹æœ¬åŸå› ã‚’ä¿®æ­£
- ç›®æ¨™: PAGE ã¯æœˆã«æ•°å›ã€1ã‚¢ãƒ©ãƒ¼ãƒˆã«ã¤ãå¿…ãšã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒä¼´ã†
```

### ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ 2: Runbook ãªã—ã®ã‚¢ãƒ©ãƒ¼ãƒˆ

```
[æ‚ªã„ä¾‹]
- ã‚¢ãƒ©ãƒ¼ãƒˆãŒæ¥ãŸãŒå¯¾å¿œæ–¹æ³•ãŒä¸æ˜
- ã€Œå‰å›ã©ã†å¯¾å¿œã—ãŸï¼Ÿã€ã‚’ Slack ã§æ¤œç´¢
- æ·±å¤œã®ã‚ªãƒ³ã‚³ãƒ¼ãƒ«ã§çµŒé¨“è€…ã«é›»è©±ã—ã¦ç¢ºèª
- åŒã˜éšœå®³ã«æ¯å›ç•°ãªã‚‹å¯¾å¿œã‚’ã—ã¦ã—ã¾ã†

[è‰¯ã„ä¾‹]
- å…¨ã‚¢ãƒ©ãƒ¼ãƒˆã« Runbook URL ã‚’ç´ä»˜ã‘
- Runbook ã®å†…å®¹:
  1. ã‚¢ãƒ©ãƒ¼ãƒˆã®æ„å‘³ã¨å½±éŸ¿ç¯„å›²
  2. ç¢ºèªã™ã¹ããƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰/ãƒ­ã‚°
  3. ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã®å¯¾å¿œæ‰‹é †
  4. ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åˆ¤æ–­åŸºæº–
  5. éå»ã®ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãƒªãƒ³ã‚¯
- Runbook ã¯éšœå®³å¯¾å¿œå¾Œã«æ›´æ–°ã™ã‚‹ç¿’æ…£ã‚’ã¤ã‘ã‚‹
```

### ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ 3: ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã®å½¢éª¸åŒ–

```
[æ‚ªã„ä¾‹]
- ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã‚’æ›¸ããŒã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ãŒæ”¾ç½®ã•ã‚Œã‚‹
- åŒã˜åŸå› ã®ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãŒç¹°ã‚Šè¿”ã—ç™ºç”Ÿ
- ã€Œå€‹äººã®æ³¨æ„ä¸è¶³ã€ãŒæ ¹æœ¬åŸå› ã«æŒ™ãŒã‚‹
- ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ãŒ blame (éé›£) ã®å ´ã«ãªã‚‹

[è‰¯ã„ä¾‹]
- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã¯å¿…ãšãƒã‚±ãƒƒãƒˆåŒ–ã—ã€æœŸé™ã¨æ‹…å½“è€…ã‚’è¨­å®š
- æœˆæ¬¡ã§ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã®é€²æ—ã‚’ç¢ºèª
- æ ¹æœ¬åŸå› ã¯ã€Œã‚·ã‚¹ãƒ†ãƒ ã®æ”¹å–„ä½™åœ°ã€ã¨ã—ã¦è¨˜è¿°
  Ã—ã€ŒAã•ã‚“ãŒãƒ†ã‚¹ãƒˆã‚’å¿˜ã‚ŒãŸã€
  â—‹ã€Œãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ–ã®ä»•çµ„ã¿ãŒãªãã€æ‰‹å‹•ãƒ†ã‚¹ãƒˆã«ä¾å­˜ã—ã¦ã„ãŸã€
- ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã®ç›®çš„ã‚’ç¹°ã‚Šè¿”ã—å‘¨çŸ¥:
  ã€ŒWho failed?ã€ã§ã¯ãªãã€ŒWhat failed?ã€
```

### ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ 4: ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä¸è¶³

```
[æ‚ªã„ä¾‹]
- ã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“ãŒä¸€äººã§2æ™‚é–“ä»¥ä¸Šæ ¼é—˜
- ã€Œã‚‚ã†å°‘ã—ã§è§£æ±ºã§ããã†ã€ã¨æ€ã£ã¦ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆã—ãªã„
- çµæœçš„ã«ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒé•·å¼•ã
- äº‹å¾Œã«ã€Œãªãœã‚‚ã£ã¨æ—©ãã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆã—ãªã‹ã£ãŸï¼Ÿã€

[è‰¯ã„ä¾‹]
- ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åˆ¤æ–­ã®æ˜æ–‡åŒ–:
  ãƒ»15åˆ†ä»¥å†…ã«åŸå› ãŒç‰¹å®šã§ããªã„ â†’ ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆ
  ãƒ»SEV-1/2 ã®ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆ â†’ å³æ™‚ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆ
  ãƒ»è‡ªåˆ†ã®å°‚é–€å¤–ã®é ˜åŸŸ â†’ å³æ™‚ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆ
- ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€Œå¼±ã•ã€ã§ã¯ãªãã€Œåˆ¤æ–­åŠ›ã€
- IC ã¯ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä¿ƒã™å½¹å‰²ã‚’æŒã¤
```

---

## 10. æœˆæ¬¡ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼

### 10.1 ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ã‚¢ã‚¸ã‚§ãƒ³ãƒ€

```
æœˆæ¬¡ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼ (60åˆ†):

  1. å…ˆæœˆã®ã‚¢ãƒ©ãƒ¼ãƒˆçµ±è¨ˆ (10åˆ†)
     ãƒ»PAGE æ•° / TICKET æ•° / NOTIFICATION æ•°
     ãƒ»MTTA (å¹³å‡å¿œç­”æ™‚é–“) / MTTR (å¹³å‡å¾©æ—§æ™‚é–“)
     ãƒ»False positive ç‡
     ãƒ»æœ€ã‚‚ç™ºå ±å›æ•°ãŒå¤šã„ã‚¢ãƒ©ãƒ¼ãƒˆ Top 5

  2. ã‚¢ãƒ©ãƒ¼ãƒˆã®æ£šå¸ã— (20åˆ†)
     ãƒ»False positive ãŒå¤šã„ã‚¢ãƒ©ãƒ¼ãƒˆ â†’ é–¾å€¤èª¿æ•´ or å‰Šé™¤
     ãƒ»å¯¾å¿œä¸è¦ã ã£ãŸã‚¢ãƒ©ãƒ¼ãƒˆ â†’ ãƒ¬ãƒ™ãƒ«å¤‰æ›´ or å‰Šé™¤
     ãƒ»æ–°ã—ãè¿½åŠ ã™ã¹ãã‚¢ãƒ©ãƒ¼ãƒˆ â†’ ä½œæˆ
     ãƒ»è‡ªå‹•ä¿®å¾©ã«ç§»è¡Œã§ãã‚‹ã‚¢ãƒ©ãƒ¼ãƒˆ â†’ è‡ªå‹•åŒ–

  3. Runbook ã®æ›´æ–° (10åˆ†)
     ãƒ»æ–°ã—ã„ã‚¢ãƒ©ãƒ¼ãƒˆã® Runbook ä½œæˆ
     ãƒ»æ—¢å­˜ Runbook ã®æ›´æ–° (æœ€æ–°ã®å¯¾å¿œæ‰‹é †)
     ãƒ»Runbook ã‚«ãƒãƒ¬ãƒƒã‚¸ã®ç¢ºèª (100% ç›®æ¨™)

  4. ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç¢ºèª (10åˆ†)
     ãƒ»æœªå®Œäº†ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã®é€²æ—
     ãƒ»å®Œäº†ã—ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®åŠ¹æœç¢ºèª

  5. ã‚ªãƒ³ã‚³ãƒ¼ãƒ«ä½“é¨“ã®æŒ¯ã‚Šè¿”ã‚Š (10åˆ†)
     ãƒ»ã‚ªãƒ³ã‚³ãƒ¼ãƒ«æ‹…å½“ã‹ã‚‰ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
     ãƒ»æ”¹å–„ææ¡ˆ
     ãƒ»æ¬¡æœˆã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª
```

### 10.2 ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ PromQL

```promql
# å…ˆæœˆã® PAGE æ•°
count(ALERTS{severity="critical", alertstate="firing"})

# ã‚¢ãƒ©ãƒ¼ãƒˆåˆ¥ã®ç™ºå ±å›æ•° (Top 10)
topk(10,
  count(ALERTS{alertstate="firing"}) by (alertname)
)

# ã‚¢ãƒ©ãƒ¼ãƒˆã®å¹³å‡ firing æ™‚é–“
avg(
  time() - ALERTS_FOR_STATE{alertstate="firing"}
) by (alertname)

# False positive ç‡ã®æ¨å®š
# (5åˆ†ä»¥å†…ã« resolve ã•ã‚ŒãŸã‚¢ãƒ©ãƒ¼ãƒˆã®å‰²åˆ)
count(ALERTS{alertstate="firing"} < 300) by (alertname)
/
count(ALERTS{alertstate="firing"}) by (alertname)
```

---

## 11. FAQ

### Q1: ã‚¢ãƒ©ãƒ¼ãƒˆã®ã—ãã„å€¤ã¯ã©ã†æ±ºã‚ã‚‹ã¹ãã§ã™ã‹ï¼Ÿ

SLO ãƒ™ãƒ¼ã‚¹ã®ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆã‚¢ãƒ©ãƒ¼ãƒˆã‚’åŸºæœ¬ã¨ã—ã€é™çš„ãªã—ãã„å€¤ï¼ˆCPU > 80% ãªã©ï¼‰ã¯è£œåŠ©çš„ã«ä½¿ã„ã¾ã™ã€‚ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆã‚¢ãƒ©ãƒ¼ãƒˆã¯ã€Œã“ã®ãƒšãƒ¼ã‚¹ã§ã‚¨ãƒ©ãƒ¼ãŒç¶šãã¨SLOã‚’å‰²ã‚‹ã€ã¨ã„ã†äºˆæ¸¬çš„ãªã‚¢ãƒ©ãƒ¼ãƒˆã§ã€ãƒ“ã‚¸ãƒã‚¹ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã«ç›´çµã—ã¾ã™ã€‚ã—ãã„å€¤ã¯æœ€åˆã¯ã‚†ã‚‹ã‚ã«è¨­å®šã—ã€é‹ç”¨ã—ãªãŒã‚‰èª¤æ¤œçŸ¥ï¼ˆfalse positiveï¼‰ã¨è¦‹é€ƒã—ï¼ˆfalse negativeï¼‰ã®ãƒãƒ©ãƒ³ã‚¹ã§èª¿æ•´ã—ã¦ãã ã•ã„ã€‚

### Q2: ã‚ªãƒ³ã‚³ãƒ¼ãƒ«ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®é©åˆ‡ãªäººæ•°ã¯ï¼Ÿ

æœ€ä½ 4ã€œ5 åã®ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ¨å¥¨ã§ã™ã€‚é€±æ¬¡ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§æœˆã«1å›ç¨‹åº¦ã®å½“ç•ªãŒç†æƒ³ã§ã™ã€‚2ã€œ3 åã§ã¯é »åº¦ãŒé«˜ã™ãã¦ç‡ƒãˆå°½ãã®ãƒªã‚¹ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€1æ¬¡æ‹…å½“ã¨ 2æ¬¡æ‹…å½“ã‚’åˆ†ã‘ã€1æ¬¡ãŒå¯¾å¿œä¸å¯ã®å ´åˆã«è‡ªå‹•ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆã™ã‚‹ä»•çµ„ã¿ã‚’æ§‹ç¯‰ã—ã¦ãã ã•ã„ã€‚

### Q3: ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã§æœ€ã‚‚é‡è¦ãªã“ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ

**blame-freeï¼ˆéé›£ã—ãªã„ï¼‰æ–‡åŒ–**ã®å¾¹åº•ã§ã™ã€‚ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã®ç›®çš„ã¯ã€Œèª°ãŒæ‚ªã‹ã£ãŸã‹ã€ã§ã¯ãªãã€Œã‚·ã‚¹ãƒ†ãƒ ã®ã©ã“ã«æ”¹å–„ä½™åœ°ãŒã‚ã‚‹ã‹ã€ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ã§ã™ã€‚å€‹äººã‚’è²¬ã‚ã‚‹ã¨æƒ…å ±ãŒéš è”½ã•ã‚Œã€çµ„ç¹”ã®å­¦ç¿’èƒ½åŠ›ãŒä½ä¸‹ã—ã¾ã™ã€‚å†ç™ºé˜²æ­¢ç­–ã¯ã€ŒäººãŒæ°—ã‚’ã¤ã‘ã‚‹ã€ã§ã¯ãªãã€Œã‚·ã‚¹ãƒ†ãƒ ã§é˜²æ­¢ã™ã‚‹ã€æ–¹å‘ã§è¨­è¨ˆã—ã¦ãã ã•ã„ã€‚

### Q4: Alertmanager ã®é«˜å¯ç”¨æ€§ã‚’ã©ã†å®Ÿç¾ã—ã¾ã™ã‹ï¼Ÿ

Alertmanager ã¯ãƒã‚¤ãƒ†ã‚£ãƒ–ã§ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚è¤‡æ•°ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ `--cluster.peer` ãƒ•ãƒ©ã‚°ã§ç›¸äº’æ¥ç¶šã—ã€ã‚¢ãƒ©ãƒ¼ãƒˆã®é‡è¤‡æ’é™¤ï¼ˆdeduplicationï¼‰ã¨è‡ªå‹•ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã‚’å®Ÿç¾ã—ã¾ã™ã€‚æœ€ä½ 2 å°ã€æ¨å¥¨ 3 å°ã®æ§‹æˆã§ã€å…¨ Prometheus ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰å…¨ Alertmanager ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«é€šçŸ¥ã‚’é€ä¿¡ã™ã‚‹è¨­å®šã«ã—ã¦ãã ã•ã„ã€‚

### Q5: ãƒ“ã‚¸ãƒã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ã‚¢ãƒ©ãƒ¼ãƒˆã¯èª°ãŒç®¡ç†ã™ã¹ãã§ã™ã‹ï¼Ÿ

ãƒ“ã‚¸ãƒã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ã‚¢ãƒ©ãƒ¼ãƒˆã¯ã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ãƒãƒ¼ãƒ ã¨ãƒ“ã‚¸ãƒã‚¹ãƒãƒ¼ãƒ ã®å”æ¥­ã§ç®¡ç†ã™ã¹ãã§ã™ã€‚ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒã‚¢ãƒ©ãƒ¼ãƒˆã®æŠ€è¡“çš„ãªå®Ÿè£…ï¼ˆPromQL / Datadog ã‚¯ã‚¨ãƒªï¼‰ã‚’æ‹…å½“ã—ã€ãƒ“ã‚¸ãƒã‚¹ãƒãƒ¼ãƒ ãŒé–¾å€¤ã¨ãƒ“ã‚¸ãƒã‚¹ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®å®šç¾©ã‚’æ‹…å½“ã—ã¾ã™ã€‚ãƒ“ã‚¸ãƒã‚¹ã‚¢ãƒ©ãƒ¼ãƒˆã¯é€šå¸¸ TICKET ãƒ¬ãƒ™ãƒ«ã§ã€å–¶æ¥­æ™‚é–“å†…ã«å¯¾å¿œã™ã‚‹è¨­è¨ˆã«ã—ã¾ã™ã€‚

### Q6: ã‚¢ãƒ©ãƒ¼ãƒˆã® Silence (æŠ‘åˆ¶) ã‚’ä½¿ã†éš›ã®æ³¨æ„ç‚¹ã¯ï¼Ÿ

Silence ã¯è¨ˆç”»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ™‚ã‚„ã€æ—¢çŸ¥ã®å•é¡Œã§ç¹°ã‚Šè¿”ã—ã‚¢ãƒ©ãƒ¼ãƒˆãŒç™ºå ±ã•ã‚Œã‚‹å ´åˆã«ä½¿ç”¨ã—ã¾ã™ã€‚æ³¨æ„ç‚¹ã¨ã—ã¦ã€(1) Silence ã«ã¯å¿…ãšæœŸé™ã‚’è¨­å®šã™ã‚‹ï¼ˆæ°¸ç¶šçš„ãª Silence ã¯ç¦æ­¢ï¼‰ã€(2) Silence ã®ç†ç”±ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã«è¨˜è¼‰ã™ã‚‹ã€(3) Silence ã®ä½œæˆ/å‰Šé™¤ã‚’ Slack ã«é€šçŸ¥ã™ã‚‹ã€(4) é€±æ¬¡ã§ä¸è¦ãª Silence ãŒãªã„ã‹ç¢ºèªã™ã‚‹ã€ãŒã‚ã‚Šã¾ã™ã€‚

---

## ã¾ã¨ã‚

| é …ç›® | è¦ç‚¹ |
|------|------|
| ã‚¢ãƒ©ãƒ¼ãƒˆè¨­è¨ˆ | PAGE/TICKET/NOTIFICATION ã®éšå±¤åŒ–ã€‚PAGE ã¯æœ€å°é™ã« |
| ãƒãƒ¼ãƒ³ãƒ¬ãƒ¼ãƒˆã‚¢ãƒ©ãƒ¼ãƒˆ | SLO ãƒ™ãƒ¼ã‚¹ã®äºˆæ¸¬çš„ã‚¢ãƒ©ãƒ¼ãƒˆã€‚Multi-window ã§èª¤æ¤œçŸ¥ã‚’ä½æ¸› |
| ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ | æ®µéšçš„ãªé€šçŸ¥å…ˆã€‚ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã§è‡ªå‹•ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆ |
| ã‚ªãƒ³ã‚³ãƒ¼ãƒ« | 4ã€œ5åãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã€‚Runbook ã‚’å¿…ãšæ•´å‚™ |
| è‡ªå‹•ä¿®å¾© | å®šå‹çš„ãªéšœå®³ã¯ Webhook/CronJob ã§è‡ªå‹•å¾©æ—§ |
| ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ  | blame-free ã§å®Ÿæ–½ã€‚ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã¯å¿…ãšãƒã‚±ãƒƒãƒˆåŒ– |
| ã‚¢ãƒ©ãƒ¼ãƒˆç–²ã‚Œ | æœˆæ¬¡æ£šå¸ã—ã§ä¸è¦ã‚¢ãƒ©ãƒ¼ãƒˆã‚’å‰Šé™¤ã€‚è‡ªå‹•ä¿®å¾©ã‚’æ¨é€² |
| ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç† | SEV ãƒ¬ãƒ™ãƒ«å®šç¾©ã€IC ã®å½¹å‰²ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸ã®é‹ç”¨ |

---

## æ¬¡ã«èª­ã‚€ã¹ãã‚¬ã‚¤ãƒ‰

- [00-observability.md](./00-observability.md) â€” ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ“ãƒªãƒ†ã‚£ã®åŸºç¤
- [01-monitoring-tools.md](./01-monitoring-tools.md) â€” ç›£è¦–ãƒ„ãƒ¼ãƒ«ã®é¸å®šã¨æ§‹ç¯‰
- [03-performance-monitoring.md](./03-performance-monitoring.md) â€” ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–

---

## å‚è€ƒæ–‡çŒ®

1. **Google SRE Book - Alerting on SLOs** â€” https://sre.google/workbook/alerting-on-slos/ â€” SLO ãƒ™ãƒ¼ã‚¹ã®ã‚¢ãƒ©ãƒ¼ãƒˆè¨­è¨ˆ
2. **PagerDuty Incident Response Guide** â€” https://response.pagerduty.com/ â€” ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
3. **Alertmanager Documentation** â€” https://prometheus.io/docs/alerting/latest/alertmanager/ â€” Alertmanager å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
4. **Etsy Debriefing Facilitation Guide** â€” https://github.com/etsy/DebriefingFacilitationGuide â€” ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ã®ãƒ•ã‚¡ã‚·ãƒªãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹æ³•
5. **incident.io** â€” https://incident.io/ â€” ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç†ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 
6. **Jeli** â€” https://www.jeli.io/ â€” ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ç®¡ç†ãƒ„ãƒ¼ãƒ«
7. **Learning from Incidents in Software** â€” https://www.learningfromincidents.io/ â€” ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‹ã‚‰ã®å­¦ç¿’
